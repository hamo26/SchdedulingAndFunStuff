   1               		.file	"bmac.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__ = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
  10               		.text
  11               	.Ltext0:
 317               	.global	rf_rx_callback
 319               	rf_rx_callback:
 320               		.stabd	46,0,0
   1:../../../src/net/bmac/rf231_soc/bmac.c **** /******************************************************************************
   2:../../../src/net/bmac/rf231_soc/bmac.c **** *  Nano-RK, a real-time operating system for sensor networks.
   3:../../../src/net/bmac/rf231_soc/bmac.c **** *  Copyright (C) 2007, Real-Time and Multimedia Lab, Carnegie Mellon University
   4:../../../src/net/bmac/rf231_soc/bmac.c **** *  All rights reserved.
   5:../../../src/net/bmac/rf231_soc/bmac.c **** *
   6:../../../src/net/bmac/rf231_soc/bmac.c **** *  This is the Open Source Version of Nano-RK included as part of a Dual
   7:../../../src/net/bmac/rf231_soc/bmac.c **** *  Licensing Model. If you are unsure which license to use please refer to:
   8:../../../src/net/bmac/rf231_soc/bmac.c **** *  http://www.nanork.org/nano-RK/wiki/Licensing
   9:../../../src/net/bmac/rf231_soc/bmac.c **** *
  10:../../../src/net/bmac/rf231_soc/bmac.c **** *  This program is free software: you can redistribute it and/or modify
  11:../../../src/net/bmac/rf231_soc/bmac.c **** *  it under the terms of the GNU General Public License as published by
  12:../../../src/net/bmac/rf231_soc/bmac.c **** *  the Free Software Foundation, version 2.0 of the License.
  13:../../../src/net/bmac/rf231_soc/bmac.c **** *
  14:../../../src/net/bmac/rf231_soc/bmac.c **** *  This program is distributed in the hope that it will be useful,
  15:../../../src/net/bmac/rf231_soc/bmac.c **** *  but WITHOUT ANY WARRANTY; without even the implied warranty of
  16:../../../src/net/bmac/rf231_soc/bmac.c **** *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  17:../../../src/net/bmac/rf231_soc/bmac.c **** *  GNU General Public License for more details.
  18:../../../src/net/bmac/rf231_soc/bmac.c **** *
  19:../../../src/net/bmac/rf231_soc/bmac.c **** *  You should have received a copy of the GNU General Public License
  20:../../../src/net/bmac/rf231_soc/bmac.c **** *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  21:../../../src/net/bmac/rf231_soc/bmac.c **** *
  22:../../../src/net/bmac/rf231_soc/bmac.c **** *  Contributing Authors (specific to this file):
  23:../../../src/net/bmac/rf231_soc/bmac.c **** *  Anthony Rowe
  24:../../../src/net/bmac/rf231_soc/bmac.c **** *******************************************************************************/
  25:../../../src/net/bmac/rf231_soc/bmac.c **** 
  26:../../../src/net/bmac/rf231_soc/bmac.c **** 
  27:../../../src/net/bmac/rf231_soc/bmac.c **** 
  28:../../../src/net/bmac/rf231_soc/bmac.c **** #include <include.h>
  29:../../../src/net/bmac/rf231_soc/bmac.c **** #include <ulib.h>
  30:../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdlib.h>
  31:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/sleep.h>
  32:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/wdt.h>
  33:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/eeprom.h>
  34:../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdio.h>
  35:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/interrupt.h>
  36:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk.h>
  37:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_events.h>
  38:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_timer.h>
  39:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_error.h>
  40:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_reserve.h>
  41:../../../src/net/bmac/rf231_soc/bmac.c **** #include <bmac.h>
  42:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_cfg.h>
  43:../../../src/net/bmac/rf231_soc/bmac.c **** 
  44:../../../src/net/bmac/rf231_soc/bmac.c **** 
  45:../../../src/net/bmac/rf231_soc/bmac.c **** #ifndef BMAC_STACKSIZE
  46:../../../src/net/bmac/rf231_soc/bmac.c **** #define BMAC_STACKSIZE 128
  47:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
  48:../../../src/net/bmac/rf231_soc/bmac.c **** 
  49:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_task_type bmac_task;
  50:../../../src/net/bmac/rf231_soc/bmac.c **** static NRK_STK bmac_task_stack[BMAC_STACKSIZE];
  51:../../../src/net/bmac/rf231_soc/bmac.c **** 
  52:../../../src/net/bmac/rf231_soc/bmac.c **** 
  53:../../../src/net/bmac/rf231_soc/bmac.c **** //#define DEBUG
  54:../../../src/net/bmac/rf231_soc/bmac.c **** static uint32_t rx_failure_cnt;
  55:../../../src/net/bmac/rf231_soc/bmac.c **** 
  56:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t tx_data_ready;
  57:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t rx_buf_empty;
  58:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t bmac_running;
  59:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t pkt_got_ack;
  60:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t g_chan;
  61:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t is_enabled;
  62:../../../src/net/bmac/rf231_soc/bmac.c **** 
  63:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t _bmac_check_period;
  64:../../../src/net/bmac/rf231_soc/bmac.c **** 
  65:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t cca_active;
  66:../../../src/net/bmac/rf231_soc/bmac.c **** static int8_t tx_reserve;
  67:../../../src/net/bmac/rf231_soc/bmac.c **** 
  68:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t dummy_t;
  69:../../../src/net/bmac/rf231_soc/bmac.c **** 
  70:../../../src/net/bmac/rf231_soc/bmac.c **** /**
  71:../../../src/net/bmac/rf231_soc/bmac.c ****  *  This is a callback if you require immediate response to a packet
  72:../../../src/net/bmac/rf231_soc/bmac.c ****  */
  73:../../../src/net/bmac/rf231_soc/bmac.c **** RF_RX_INFO *rf_rx_callback (RF_RX_INFO * pRRI)
  74:../../../src/net/bmac/rf231_soc/bmac.c **** {
 322               	.LM0:
 323               	.LFBB1:
 324               	/* prologue: function */
 325               	/* frame size = 0 */
 326               	/* stack size = 0 */
 327               	.L__stack_usage = 0
 328               	/* epilogue start */
  75:../../../src/net/bmac/rf231_soc/bmac.c ****   // Any code here gets called the instant a packet is received from the interrupt   
  76:../../../src/net/bmac/rf231_soc/bmac.c ****   return pRRI;
  77:../../../src/net/bmac/rf231_soc/bmac.c **** }
 330               	.LM1:
 331 0000 0895      		ret
 333               	.Lscope1:
 335               		.stabd	78,0,0
 339               	.global	bmac_encryption_set_ctr_counter
 341               	bmac_encryption_set_ctr_counter:
 342               		.stabd	46,0,0
  78:../../../src/net/bmac/rf231_soc/bmac.c **** 
  79:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_ctr_counter (uint8_t * counter, uint8_t len)
  80:../../../src/net/bmac/rf231_soc/bmac.c **** {
 344               	.LM2:
 345               	.LFBB2:
 346               	/* prologue: function */
 347               	/* frame size = 0 */
 348               	/* stack size = 0 */
 349               	.L__stack_usage = 0
  81:../../../src/net/bmac/rf231_soc/bmac.c ****   if (len != 4)
 351               	.LM3:
 352 0002 6430      		cpi r22,lo8(4)
 353 0004 01F4      		brne .L4
  82:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
  83:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_security_set_ctr_counter (counter);
 355               	.LM4:
 356 0006 0E94 0000 		call rf_security_set_ctr_counter
  84:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 358               	.LM5:
 359 000a 81E0      		ldi r24,lo8(1)
 360 000c 0895      		ret
 361               	.L4:
  82:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 363               	.LM6:
 364 000e 8FEF      		ldi r24,lo8(-1)
  85:../../../src/net/bmac/rf231_soc/bmac.c **** }
 366               	.LM7:
 367 0010 0895      		ret
 369               	.Lscope2:
 371               		.stabd	78,0,0
 375               	.global	bmac_tx_reserve_set
 377               	bmac_tx_reserve_set:
 378               		.stabd	46,0,0
  86:../../../src/net/bmac/rf231_soc/bmac.c **** 
  87:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_reserve_set (nrk_time_t * period, uint16_t pkts)
  88:../../../src/net/bmac/rf231_soc/bmac.c **** {
 380               	.LM8:
 381               	.LFBB3:
 382               	/* prologue: function */
 383               	/* frame size = 0 */
 384               	/* stack size = 0 */
 385               	.L__stack_usage = 0
  89:../../../src/net/bmac/rf231_soc/bmac.c **** 
  90:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
  91:../../../src/net/bmac/rf231_soc/bmac.c **** // Create a reserve if it doesn't exist
  92:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve == -1)
  93:../../../src/net/bmac/rf231_soc/bmac.c ****     tx_reserve = nrk_reserve_create ();
  94:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve >= 0)
  95:../../../src/net/bmac/rf231_soc/bmac.c ****     return nrk_reserve_set (tx_reserve, period, pkts, NULL);
  96:../../../src/net/bmac/rf231_soc/bmac.c ****   else
  97:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
  98:../../../src/net/bmac/rf231_soc/bmac.c **** #else
  99:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_ERROR;
 100:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 101:../../../src/net/bmac/rf231_soc/bmac.c **** }
 387               	.LM9:
 388 0012 8FEF      		ldi r24,lo8(-1)
 389               	/* epilogue start */
 390 0014 0895      		ret
 392               	.Lscope3:
 394               		.stabd	78,0,0
 396               	.global	bmac_tx_reserve_get
 398               	bmac_tx_reserve_get:
 399               		.stabd	46,0,0
 102:../../../src/net/bmac/rf231_soc/bmac.c **** 
 103:../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_tx_reserve_get ()
 104:../../../src/net/bmac/rf231_soc/bmac.c **** {
 401               	.LM10:
 402               	.LFBB4:
 403               	/* prologue: function */
 404               	/* frame size = 0 */
 405               	/* stack size = 0 */
 406               	.L__stack_usage = 0
 105:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 106:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve >= 0)
 107:../../../src/net/bmac/rf231_soc/bmac.c ****     return nrk_reserve_get (tx_reserve);
 108:../../../src/net/bmac/rf231_soc/bmac.c ****   else
 109:../../../src/net/bmac/rf231_soc/bmac.c ****     return 0;
 110:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 111:../../../src/net/bmac/rf231_soc/bmac.c ****   return 0;
 112:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 113:../../../src/net/bmac/rf231_soc/bmac.c **** }
 408               	.LM11:
 409 0016 80E0      		ldi r24,lo8(0)
 410 0018 90E0      		ldi r25,hi8(0)
 411               	/* epilogue start */
 412 001a 0895      		ret
 414               	.Lscope4:
 416               		.stabd	78,0,0
 418               	.global	bmac_auto_ack_disable
 420               	bmac_auto_ack_disable:
 421               		.stabd	46,0,0
 114:../../../src/net/bmac/rf231_soc/bmac.c **** 
 115:../../../src/net/bmac/rf231_soc/bmac.c **** 
 116:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_disable ()
 117:../../../src/net/bmac/rf231_soc/bmac.c **** {
 423               	.LM12:
 424               	.LFBB5:
 425               	/* prologue: function */
 426               	/* frame size = 0 */
 427               	/* stack size = 0 */
 428               	.L__stack_usage = 0
 118:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_auto_ack_disable ();
 430               	.LM13:
 431 001c 0E94 0000 		call rf_auto_ack_disable
 119:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 120:../../../src/net/bmac/rf231_soc/bmac.c **** }
 433               	.LM14:
 434 0020 81E0      		ldi r24,lo8(1)
 435               	/* epilogue start */
 436 0022 0895      		ret
 438               	.Lscope5:
 440               		.stabd	78,0,0
 442               	.global	bmac_auto_ack_enable
 444               	bmac_auto_ack_enable:
 445               		.stabd	46,0,0
 121:../../../src/net/bmac/rf231_soc/bmac.c **** 
 122:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_enable ()
 123:../../../src/net/bmac/rf231_soc/bmac.c **** {
 447               	.LM15:
 448               	.LFBB6:
 449               	/* prologue: function */
 450               	/* frame size = 0 */
 451               	/* stack size = 0 */
 452               	.L__stack_usage = 0
 124:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_auto_ack_enable ();
 454               	.LM16:
 455 0024 0E94 0000 		call rf_auto_ack_enable
 125:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 126:../../../src/net/bmac/rf231_soc/bmac.c **** }
 457               	.LM17:
 458 0028 81E0      		ldi r24,lo8(1)
 459               	/* epilogue start */
 460 002a 0895      		ret
 462               	.Lscope6:
 464               		.stabd	78,0,0
 466               	.global	bmac_addr_decode_disable
 468               	bmac_addr_decode_disable:
 469               		.stabd	46,0,0
 127:../../../src/net/bmac/rf231_soc/bmac.c **** 
 128:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_disable ()
 129:../../../src/net/bmac/rf231_soc/bmac.c **** {
 471               	.LM18:
 472               	.LFBB7:
 473               	/* prologue: function */
 474               	/* frame size = 0 */
 475               	/* stack size = 0 */
 476               	.L__stack_usage = 0
 130:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_disable ();
 478               	.LM19:
 479 002c 0E94 0000 		call rf_addr_decode_disable
 131:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 132:../../../src/net/bmac/rf231_soc/bmac.c **** }
 481               	.LM20:
 482 0030 81E0      		ldi r24,lo8(1)
 483               	/* epilogue start */
 484 0032 0895      		ret
 486               	.Lscope7:
 488               		.stabd	78,0,0
 490               	.global	bmac_addr_decode_enable
 492               	bmac_addr_decode_enable:
 493               		.stabd	46,0,0
 133:../../../src/net/bmac/rf231_soc/bmac.c **** 
 134:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_enable ()
 135:../../../src/net/bmac/rf231_soc/bmac.c **** {
 495               	.LM21:
 496               	.LFBB8:
 497               	/* prologue: function */
 498               	/* frame size = 0 */
 499               	/* stack size = 0 */
 500               	.L__stack_usage = 0
 136:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_enable ();
 502               	.LM22:
 503 0034 0E94 0000 		call rf_addr_decode_enable
 137:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 138:../../../src/net/bmac/rf231_soc/bmac.c **** }
 505               	.LM23:
 506 0038 81E0      		ldi r24,lo8(1)
 507               	/* epilogue start */
 508 003a 0895      		ret
 510               	.Lscope8:
 512               		.stabd	78,0,0
 515               	.global	bmac_addr_decode_set_my_mac
 517               	bmac_addr_decode_set_my_mac:
 518               		.stabd	46,0,0
 139:../../../src/net/bmac/rf231_soc/bmac.c **** 
 140:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_set_my_mac (uint16_t my_mac)
 141:../../../src/net/bmac/rf231_soc/bmac.c **** {
 520               	.LM24:
 521               	.LFBB9:
 522               	/* prologue: function */
 523               	/* frame size = 0 */
 524               	/* stack size = 0 */
 525               	.L__stack_usage = 0
 142:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_set_my_mac (my_mac);
 527               	.LM25:
 528 003c 0E94 0000 		call rf_addr_decode_set_my_mac
 143:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 144:../../../src/net/bmac/rf231_soc/bmac.c **** }
 530               	.LM26:
 531 0040 81E0      		ldi r24,lo8(1)
 532               	/* epilogue start */
 533 0042 0895      		ret
 535               	.Lscope9:
 537               		.stabd	78,0,0
 540               	.global	bmac_addr_decode_dest_mac
 542               	bmac_addr_decode_dest_mac:
 543               		.stabd	46,0,0
 145:../../../src/net/bmac/rf231_soc/bmac.c **** 
 146:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_dest_mac (uint16_t dest)
 147:../../../src/net/bmac/rf231_soc/bmac.c **** {
 545               	.LM27:
 546               	.LFBB10:
 547               	/* prologue: function */
 548               	/* frame size = 0 */
 549               	/* stack size = 0 */
 550               	.L__stack_usage = 0
 148:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.destAddr = dest;
 552               	.LM28:
 553 0044 9093 0000 		sts bmac_rfTxInfo+1,r25
 554 0048 8093 0000 		sts bmac_rfTxInfo,r24
 149:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 150:../../../src/net/bmac/rf231_soc/bmac.c **** }
 556               	.LM29:
 557 004c 81E0      		ldi r24,lo8(1)
 558               	/* epilogue start */
 559 004e 0895      		ret
 561               	.Lscope10:
 563               		.stabd	78,0,0
 565               	.global	bmac_rx_pkt_is_encrypted
 567               	bmac_rx_pkt_is_encrypted:
 568               		.stabd	46,0,0
 151:../../../src/net/bmac/rf231_soc/bmac.c **** 
 152:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_is_encrypted ()
 153:../../../src/net/bmac/rf231_soc/bmac.c **** {
 570               	.LM30:
 571               	.LFBB11:
 572               	/* prologue: function */
 573               	/* frame size = 0 */
 574               	/* stack size = 0 */
 575               	.L__stack_usage = 0
 154:../../../src/net/bmac/rf231_soc/bmac.c ****   return rf_security_last_pkt_status ();
 577               	.LM31:
 578 0050 0E94 0000 		call rf_security_last_pkt_status
 579               	/* epilogue start */
 155:../../../src/net/bmac/rf231_soc/bmac.c **** }
 581               	.LM32:
 582 0054 0895      		ret
 584               	.Lscope11:
 586               		.stabd	78,0,0
 590               	.global	bmac_encryption_set_key
 592               	bmac_encryption_set_key:
 593               		.stabd	46,0,0
 156:../../../src/net/bmac/rf231_soc/bmac.c **** 
 157:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_key (uint8_t * key, uint8_t len)
 158:../../../src/net/bmac/rf231_soc/bmac.c **** {
 595               	.LM33:
 596               	.LFBB12:
 597               	/* prologue: function */
 598               	/* frame size = 0 */
 599               	/* stack size = 0 */
 600               	.L__stack_usage = 0
 159:../../../src/net/bmac/rf231_soc/bmac.c ****   if (len != 16)
 602               	.LM34:
 603 0056 6031      		cpi r22,lo8(16)
 604 0058 01F4      		brne .L16
 160:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 161:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_security_set_key (key);
 606               	.LM35:
 607 005a 0E94 0000 		call rf_security_set_key
 162:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 609               	.LM36:
 610 005e 81E0      		ldi r24,lo8(1)
 611 0060 0895      		ret
 612               	.L16:
 160:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 614               	.LM37:
 615 0062 8FEF      		ldi r24,lo8(-1)
 163:../../../src/net/bmac/rf231_soc/bmac.c **** }
 617               	.LM38:
 618 0064 0895      		ret
 620               	.Lscope12:
 622               		.stabd	78,0,0
 624               	.global	bmac_encryption_enable
 626               	bmac_encryption_enable:
 627               		.stabd	46,0,0
 164:../../../src/net/bmac/rf231_soc/bmac.c **** 
 165:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_enable ()
 166:../../../src/net/bmac/rf231_soc/bmac.c **** {
 629               	.LM39:
 630               	.LFBB13:
 631               	/* prologue: function */
 632               	/* frame size = 0 */
 633               	/* stack size = 0 */
 634               	.L__stack_usage = 0
 167:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_security_enable();
 168:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 169:../../../src/net/bmac/rf231_soc/bmac.c **** }
 636               	.LM40:
 637 0066 81E0      		ldi r24,lo8(1)
 638               	/* epilogue start */
 639 0068 0895      		ret
 641               	.Lscope13:
 643               		.stabd	78,0,0
 645               	.global	bmac_encryption_disable
 647               	bmac_encryption_disable:
 648               		.stabd	46,0,0
 170:../../../src/net/bmac/rf231_soc/bmac.c **** 
 171:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_disable ()
 172:../../../src/net/bmac/rf231_soc/bmac.c **** {
 650               	.LM41:
 651               	.LFBB14:
 652               	/* prologue: function */
 653               	/* frame size = 0 */
 654               	/* stack size = 0 */
 655               	.L__stack_usage = 0
 173:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_security_disable();
 174:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 175:../../../src/net/bmac/rf231_soc/bmac.c **** }
 657               	.LM42:
 658 006a 81E0      		ldi r24,lo8(1)
 659               	/* epilogue start */
 660 006c 0895      		ret
 662               	.Lscope14:
 664               		.stabd	78,0,0
 667               	.global	bmac_set_rf_power
 669               	bmac_set_rf_power:
 670               		.stabd	46,0,0
 176:../../../src/net/bmac/rf231_soc/bmac.c **** 
 177:../../../src/net/bmac/rf231_soc/bmac.c **** 
 178:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rf_power (uint8_t power)
 179:../../../src/net/bmac/rf231_soc/bmac.c **** {
 672               	.LM43:
 673               	.LFBB15:
 674               	/* prologue: function */
 675               	/* frame size = 0 */
 676               	/* stack size = 0 */
 677               	.L__stack_usage = 0
 180:../../../src/net/bmac/rf231_soc/bmac.c ****   if (power > 31)
 679               	.LM44:
 680 006e 8032      		cpi r24,lo8(32)
 681 0070 00F4      		brsh .L21
 181:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 182:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_tx_power (power);
 683               	.LM45:
 684 0072 0E94 0000 		call rf_tx_power
 183:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 686               	.LM46:
 687 0076 81E0      		ldi r24,lo8(1)
 688 0078 0895      		ret
 689               	.L21:
 181:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 691               	.LM47:
 692 007a 8FEF      		ldi r24,lo8(-1)
 184:../../../src/net/bmac/rf231_soc/bmac.c **** }
 694               	.LM48:
 695 007c 0895      		ret
 697               	.Lscope15:
 699               		.stabd	78,0,0
 702               	.global	bmac_set_cca_active
 704               	bmac_set_cca_active:
 705               		.stabd	46,0,0
 185:../../../src/net/bmac/rf231_soc/bmac.c **** 
 186:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_set_cca_active (uint8_t active)
 187:../../../src/net/bmac/rf231_soc/bmac.c **** {
 707               	.LM49:
 708               	.LFBB16:
 709               	/* prologue: function */
 710               	/* frame size = 0 */
 711               	/* stack size = 0 */
 712               	.L__stack_usage = 0
 188:../../../src/net/bmac/rf231_soc/bmac.c ****   cca_active = active;
 714               	.LM50:
 715 007e 8093 0000 		sts cca_active,r24
 716               	/* epilogue start */
 189:../../../src/net/bmac/rf231_soc/bmac.c **** }
 718               	.LM51:
 719 0082 0895      		ret
 721               	.Lscope16:
 723               		.stabd	78,0,0
 726               	.global	bmac_set_cca_thresh
 728               	bmac_set_cca_thresh:
 729               		.stabd	46,0,0
 190:../../../src/net/bmac/rf231_soc/bmac.c **** 
 191:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_cca_thresh (int8_t thresh)
 192:../../../src/net/bmac/rf231_soc/bmac.c **** {
 731               	.LM52:
 732               	.LFBB17:
 733               	/* prologue: function */
 734               	/* frame size = 0 */
 735               	/* stack size = 0 */
 736               	.L__stack_usage = 0
 193:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_set_cca_thresh (thresh);
 738               	.LM53:
 739 0084 9927      		clr r25
 740 0086 87FD      		sbrc r24,7
 741 0088 9095      		com r25
 742 008a 0E94 0000 		call rf_set_cca_thresh
 194:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 195:../../../src/net/bmac/rf231_soc/bmac.c **** }
 744               	.LM54:
 745 008e 81E0      		ldi r24,lo8(1)
 746               	/* epilogue start */
 747 0090 0895      		ret
 749               	.Lscope17:
 751               		.stabd	78,0,0
 754               	.global	bmac_set_channel
 756               	bmac_set_channel:
 757               		.stabd	46,0,0
 196:../../../src/net/bmac/rf231_soc/bmac.c **** 
 197:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_channel (uint8_t chan)
 198:../../../src/net/bmac/rf231_soc/bmac.c **** {
 759               	.LM55:
 760               	.LFBB18:
 761 0092 DF93      		push r29
 762 0094 CF93      		push r28
 763 0096 0F92      		push __tmp_reg__
 764 0098 CDB7      		in r28,__SP_L__
 765 009a DEB7      		in r29,__SP_H__
 766               	/* prologue: function */
 767               	/* frame size = 1 */
 768               	/* stack size = 3 */
 769               	.L__stack_usage = 3
 199:../../../src/net/bmac/rf231_soc/bmac.c ****   if (chan > 26)
 771               	.LM56:
 772 009c 8B31      		cpi r24,lo8(27)
 773 009e 00F4      		brsh .L26
 200:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 201:../../../src/net/bmac/rf231_soc/bmac.c ****   g_chan = chan;
 775               	.LM57:
 776 00a0 8093 0000 		sts g_chan,r24
 202:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 778               	.LM58:
 779 00a4 8983      		std Y+1,r24
 780 00a6 0E94 0000 		call rf_power_up
 203:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_init (&bmac_rfRxInfo, chan, 0xFFFF, 0x00000);
 782               	.LM59:
 783 00aa 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 784 00ac 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 785 00ae 6981      		ldd r22,Y+1
 786 00b0 4FEF      		ldi r20,lo8(-1)
 787 00b2 5FEF      		ldi r21,hi8(-1)
 788 00b4 20E0      		ldi r18,lo8(0)
 789 00b6 30E0      		ldi r19,hi8(0)
 790 00b8 0E94 0000 		call rf_init
 204:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 792               	.LM60:
 793 00bc 81E0      		ldi r24,lo8(1)
 794 00be 00C0      		rjmp .L25
 795               	.L26:
 200:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 797               	.LM61:
 798 00c0 8FEF      		ldi r24,lo8(-1)
 799               	.L25:
 800               	/* epilogue start */
 205:../../../src/net/bmac/rf231_soc/bmac.c **** }
 802               	.LM62:
 803 00c2 0F90      		pop __tmp_reg__
 804 00c4 CF91      		pop r28
 805 00c6 DF91      		pop r29
 806 00c8 0895      		ret
 808               	.Lscope18:
 810               		.stabd	78,0,0
 812               	.global	bmac_wait_until_rx_pkt
 814               	bmac_wait_until_rx_pkt:
 815               		.stabd	46,0,0
 206:../../../src/net/bmac/rf231_soc/bmac.c **** 
 207:../../../src/net/bmac/rf231_soc/bmac.c **** 
 208:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_wait_until_rx_pkt ()
 209:../../../src/net/bmac/rf231_soc/bmac.c **** {
 817               	.LM63:
 818               	.LFBB19:
 819               	/* prologue: function */
 820               	/* frame size = 0 */
 821               	/* stack size = 0 */
 822               	.L__stack_usage = 0
 210:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sig_mask_t event;
 211:../../../src/net/bmac/rf231_soc/bmac.c **** 
 212:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_ready () == 1)
 824               	.LM64:
 825 00ca 8091 0000 		lds r24,rx_buf_empty
 826 00ce 8823      		tst r24
 827 00d0 01F0      		breq .L29
 213:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 214:../../../src/net/bmac/rf231_soc/bmac.c **** 
 215:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_rx_pkt_signal);
 829               	.LM65:
 830 00d2 8091 0000 		lds r24,bmac_rx_pkt_signal
 831 00d6 0E94 0000 		call nrk_signal_register
 216:../../../src/net/bmac/rf231_soc/bmac.c ****   event = nrk_event_wait (SIG (bmac_rx_pkt_signal));
 833               	.LM66:
 834 00da 61E0      		ldi r22,lo8(1)
 835 00dc 70E0      		ldi r23,hi8(1)
 836 00de 80E0      		ldi r24,hlo8(1)
 837 00e0 90E0      		ldi r25,hhi8(1)
 838 00e2 0090 0000 		lds r0,bmac_rx_pkt_signal
 839 00e6 00C0      		rjmp 2f
 840 00e8 660F      	1:	lsl r22
 841 00ea 771F      		rol r23
 842 00ec 881F      		rol r24
 843 00ee 991F      		rol r25
 844 00f0 0A94      	2:	dec r0
 845 00f2 02F4      		brpl 1b
 846 00f4 0E94 0000 		call nrk_event_wait
 217:../../../src/net/bmac/rf231_soc/bmac.c **** 
 218:../../../src/net/bmac/rf231_soc/bmac.c **** // Check if it was a time out instead of packet RX signal
 219:../../../src/net/bmac/rf231_soc/bmac.c ****   if ((event & SIG (bmac_rx_pkt_signal)) == 0)
 848               	.LM67:
 849 00f8 0090 0000 		lds r0,bmac_rx_pkt_signal
 850 00fc 00C0      		rjmp 2f
 851 00fe 9695      	1:	lsr r25
 852 0100 8795      		ror r24
 853 0102 7795      		ror r23
 854 0104 6795      		ror r22
 855 0106 0A94      	2:	dec r0
 856 0108 02F4      		brpl 1b
 857 010a 60FD      		sbrc r22,0
 858 010c 00C0      		rjmp .L30
 220:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 860               	.LM68:
 861 010e 8FEF      		ldi r24,lo8(-1)
 862 0110 0895      		ret
 863               	.L29:
 213:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 865               	.LM69:
 866 0112 81E0      		ldi r24,lo8(1)
 867 0114 0895      		ret
 868               	.L30:
 221:../../../src/net/bmac/rf231_soc/bmac.c ****   else
 222:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 870               	.LM70:
 871 0116 81E0      		ldi r24,lo8(1)
 223:../../../src/net/bmac/rf231_soc/bmac.c **** }
 873               	.LM71:
 874 0118 0895      		ret
 876               	.Lscope19:
 878               		.stabd	78,0,0
 882               	.global	bmac_rx_pkt_set_buffer
 884               	bmac_rx_pkt_set_buffer:
 885               		.stabd	46,0,0
 224:../../../src/net/bmac/rf231_soc/bmac.c **** 
 225:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_set_buffer (uint8_t * buf, uint8_t size)
 226:../../../src/net/bmac/rf231_soc/bmac.c **** {
 887               	.LM72:
 888               	.LFBB20:
 889               	/* prologue: function */
 890               	/* frame size = 0 */
 891               	/* stack size = 0 */
 892               	.L__stack_usage = 0
 227:../../../src/net/bmac/rf231_soc/bmac.c ****   if (buf == NULL)
 894               	.LM73:
 895 011a 0097      		sbiw r24,0
 896 011c 01F0      		breq .L33
 228:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 229:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.pPayload = buf;
 898               	.LM74:
 899 011e 9093 0000 		sts bmac_rfRxInfo+5+1,r25
 900 0122 8093 0000 		sts bmac_rfRxInfo+5,r24
 230:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.max_length = size;
 902               	.LM75:
 903 0126 6093 0000 		sts bmac_rfRxInfo+4,r22
 231:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 1;
 905               	.LM76:
 906 012a 81E0      		ldi r24,lo8(1)
 907 012c 8093 0000 		sts rx_buf_empty,r24
 232:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 909               	.LM77:
 910 0130 0895      		ret
 911               	.L33:
 228:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 913               	.LM78:
 914 0132 8FEF      		ldi r24,lo8(-1)
 233:../../../src/net/bmac/rf231_soc/bmac.c **** }
 916               	.LM79:
 917 0134 0895      		ret
 919               	.Lscope20:
 921               		.stabd	78,0,0
 924               	.global	bmac_init
 926               	bmac_init:
 927               		.stabd	46,0,0
 234:../../../src/net/bmac/rf231_soc/bmac.c **** 
 235:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_init (uint8_t chan)
 236:../../../src/net/bmac/rf231_soc/bmac.c **** {
 929               	.LM80:
 930               	.LFBB21:
 931 0136 0F93      		push r16
 932 0138 1F93      		push r17
 933               	/* prologue: function */
 934               	/* frame size = 0 */
 935               	/* stack size = 2 */
 936               	.L__stack_usage = 2
 937 013a 082F      		mov r16,r24
 237:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_running = 0;
 939               	.LM81:
 940 013c 1092 0000 		sts bmac_running,__zero_reg__
 238:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_reserve = -1;
 942               	.LM82:
 943 0140 8FEF      		ldi r24,lo8(-1)
 944 0142 8093 0000 		sts tx_reserve,r24
 239:../../../src/net/bmac/rf231_soc/bmac.c ****   cca_active = true;
 946               	.LM83:
 947 0146 11E0      		ldi r17,lo8(1)
 948 0148 1093 0000 		sts cca_active,r17
 240:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_failure_cnt = 0;
 950               	.LM84:
 951 014c 1092 0000 		sts rx_failure_cnt,__zero_reg__
 952 0150 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 953 0154 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 954 0158 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 241:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 242:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 243:../../../src/net/bmac/rf231_soc/bmac.c **** 
 244:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = 30;
 245:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = 0;
 246:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sw_wdt_init (BMAC_SW_WDT_ID, &_bmac_check_period, NULL);
 247:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sw_wdt_start (BMAC_SW_WDT_ID);
 248:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 249:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 250:../../../src/net/bmac/rf231_soc/bmac.c **** 
 251:../../../src/net/bmac/rf231_soc/bmac.c **** 
 252:../../../src/net/bmac/rf231_soc/bmac.c **** 
 253:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = 0;
 956               	.LM85:
 957 015c 1092 0000 		sts _bmac_check_period,__zero_reg__
 958 0160 1092 0000 		sts _bmac_check_period+1,__zero_reg__
 959 0164 1092 0000 		sts _bmac_check_period+2,__zero_reg__
 960 0168 1092 0000 		sts _bmac_check_period+3,__zero_reg__
 254:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = BMAC_DEFAULT_CHECK_RATE_MS * NANOS_PER_MS;
 962               	.LM86:
 963 016c 20E0      		ldi r18,lo8(100000000)
 964 016e 31EE      		ldi r19,hi8(100000000)
 965 0170 45EF      		ldi r20,hlo8(100000000)
 966 0172 55E0      		ldi r21,hhi8(100000000)
 967 0174 2093 0000 		sts _bmac_check_period+4,r18
 968 0178 3093 0000 		sts _bmac_check_period+4+1,r19
 969 017c 4093 0000 		sts _bmac_check_period+4+2,r20
 970 0180 5093 0000 		sts _bmac_check_period+4+3,r21
 255:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rx_pkt_signal = nrk_signal_create ();
 972               	.LM87:
 973 0184 0E94 0000 		call nrk_signal_create
 974 0188 8093 0000 		sts bmac_rx_pkt_signal,r24
 256:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_signal == NRK_ERROR) {
 976               	.LM88:
 977 018c 8F3F      		cpi r24,lo8(-1)
 978 018e 01F4      		brne .L35
 257:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating rx signal failed\r\n"));
 980               	.LM89:
 981 0190 80E0      		ldi r24,lo8(__c.3106)
 982 0192 90E0      		ldi r25,hi8(__c.3106)
 983 0194 00C0      		rjmp .L39
 984               	.L35:
 258:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 259:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 260:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 261:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_tx_pkt_done_signal = nrk_signal_create ();
 986               	.LM90:
 987 0196 0E94 0000 		call nrk_signal_create
 988 019a 8093 0000 		sts bmac_tx_pkt_done_signal,r24
 262:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_tx_pkt_done_signal == NRK_ERROR) {
 990               	.LM91:
 991 019e 8F3F      		cpi r24,lo8(-1)
 992 01a0 01F4      		brne .L37
 263:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating tx signal failed\r\n"));
 994               	.LM92:
 995 01a2 80E0      		ldi r24,lo8(__c.3108)
 996 01a4 90E0      		ldi r25,hi8(__c.3108)
 997               	.L39:
 998 01a6 0E94 0000 		call nrk_kprintf
 264:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 1000               	.LM93:
 1001 01aa E091 0000 		lds r30,nrk_cur_task_TCB
 1002 01ae F091 0000 		lds r31,nrk_cur_task_TCB+1
 1003 01b2 8EE0      		ldi r24,lo8(14)
 1004 01b4 6085      		ldd r22,Z+8
 1005 01b6 0E94 0000 		call nrk_kernel_error_add
 265:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1007               	.LM94:
 1008 01ba 8FEF      		ldi r24,lo8(-1)
 1009 01bc 00C0      		rjmp .L36
 1010               	.L37:
 266:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 267:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_enable_signal = nrk_signal_create ();
 1012               	.LM95:
 1013 01be 0E94 0000 		call nrk_signal_create
 1014 01c2 8093 0000 		sts bmac_enable_signal,r24
 268:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_enable_signal == NRK_ERROR) {
 1016               	.LM96:
 1017 01c6 8F3F      		cpi r24,lo8(-1)
 1018 01c8 01F4      		brne .L38
 269:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating enable signal failed\r\n"));
 1020               	.LM97:
 1021 01ca 80E0      		ldi r24,lo8(__c.3110)
 1022 01cc 90E0      		ldi r25,hi8(__c.3110)
 1023 01ce 00C0      		rjmp .L39
 1024               	.L38:
 270:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 271:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 272:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 273:../../../src/net/bmac/rf231_soc/bmac.c **** 
 274:../../../src/net/bmac/rf231_soc/bmac.c **** 
 275:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 1026               	.LM98:
 1027 01d0 1092 0000 		sts tx_data_ready,__zero_reg__
 276:../../../src/net/bmac/rf231_soc/bmac.c ****   // Set the one main rx buffer
 277:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 0;
 1029               	.LM99:
 1030 01d4 1092 0000 		sts rx_buf_empty,__zero_reg__
 278:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.pPayload = NULL;
 1032               	.LM100:
 1033 01d8 1092 0000 		sts bmac_rfRxInfo+5+1,__zero_reg__
 1034 01dc 1092 0000 		sts bmac_rfRxInfo+5,__zero_reg__
 279:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.max_length = 0;
 1036               	.LM101:
 1037 01e0 1092 0000 		sts bmac_rfRxInfo+4,__zero_reg__
 280:../../../src/net/bmac/rf231_soc/bmac.c **** 
 281:../../../src/net/bmac/rf231_soc/bmac.c ****   // Setup the cc2420 chip
 282:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 1039               	.LM102:
 1040 01e4 0E94 0000 		call rf_power_up
 283:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_init (&bmac_rfRxInfo, chan, 0xffff, 0);
 1042               	.LM103:
 1043 01e8 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 1044 01ea 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 1045 01ec 602F      		mov r22,r16
 1046 01ee 4FEF      		ldi r20,lo8(-1)
 1047 01f0 5FEF      		ldi r21,hi8(-1)
 1048 01f2 20E0      		ldi r18,lo8(0)
 1049 01f4 30E0      		ldi r19,hi8(0)
 1050 01f6 0E94 0000 		call rf_init
 284:../../../src/net/bmac/rf231_soc/bmac.c ****   g_chan = chan;
 1052               	.LM104:
 1053 01fa 0093 0000 		sts g_chan,r16
 285:../../../src/net/bmac/rf231_soc/bmac.c **** 
 286:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_RSSI, 0xE580); // CCA THR=-25
 287:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_TXCTRL, 0x80FF); // TX TURNAROUND = 128 us
 288:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_RXCTRL1, 0x0A56); 
 289:../../../src/net/bmac/rf231_soc/bmac.c ****   // default cca thresh of -45
 290:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_set_cca_thresh(-45); 
 291:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_set_cca_thresh (0x0);
 1055               	.LM105:
 1056 01fe 80E0      		ldi r24,lo8(0)
 1057 0200 90E0      		ldi r25,hi8(0)
 1058 0202 0E94 0000 		call rf_set_cca_thresh
 292:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_running = 1;
 1060               	.LM106:
 1061 0206 1093 0000 		sts bmac_running,r17
 293:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 1;
 1063               	.LM107:
 1064 020a 1093 0000 		sts is_enabled,r17
 294:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1066               	.LM108:
 1067 020e 81E0      		ldi r24,lo8(1)
 1068               	.L36:
 1069               	/* epilogue start */
 295:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1071               	.LM109:
 1072 0210 1F91      		pop r17
 1073 0212 0F91      		pop r16
 1074 0214 0895      		ret
 1076               	.Lscope21:
 1078               		.stabd	78,0,0
 1082               	.global	bmac_tx_pkt_nonblocking
 1084               	bmac_tx_pkt_nonblocking:
 1085               		.stabd	46,0,0
 296:../../../src/net/bmac/rf231_soc/bmac.c **** 
 297:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt_nonblocking (uint8_t * buf, uint8_t len)
 298:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1087               	.LM110:
 1088               	.LFBB22:
 1089               	/* prologue: function */
 1090               	/* frame size = 0 */
 1091               	/* stack size = 0 */
 1092               	.L__stack_usage = 0
 299:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_data_ready == 1)
 1094               	.LM111:
 1095 0216 2091 0000 		lds r18,tx_data_ready
 1096 021a 2130      		cpi r18,lo8(1)
 1097 021c 01F0      		breq .L42
 300:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 301:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 1;
 1099               	.LM112:
 1100 021e 21E0      		ldi r18,lo8(1)
 1101 0220 2093 0000 		sts tx_data_ready,r18
 302:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.pPayload = buf;
 1103               	.LM113:
 1104 0224 9093 0000 		sts bmac_rfTxInfo+3+1,r25
 1105 0228 8093 0000 		sts bmac_rfTxInfo+3,r24
 303:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.length = len;
 1107               	.LM114:
 1108 022c 6093 0000 		sts bmac_rfTxInfo+2,r22
 304:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1110               	.LM115:
 1111 0230 81E0      		ldi r24,lo8(1)
 1112 0232 0895      		ret
 1113               	.L42:
 300:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1115               	.LM116:
 1116 0234 8FEF      		ldi r24,lo8(-1)
 305:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1118               	.LM117:
 1119 0236 0895      		ret
 1121               	.Lscope22:
 1123               		.stabd	78,0,0
 1125               	.global	bmac_get_rx_pkt_signal
 1127               	bmac_get_rx_pkt_signal:
 1128               		.stabd	46,0,0
 306:../../../src/net/bmac/rf231_soc/bmac.c **** 
 307:../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_rx_pkt_signal ()
 308:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1130               	.LM118:
 1131               	.LFBB23:
 1132               	/* prologue: function */
 1133               	/* frame size = 0 */
 1134               	/* stack size = 0 */
 1135               	.L__stack_usage = 0
 309:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_rx_pkt_signal);
 1137               	.LM119:
 1138 0238 8091 0000 		lds r24,bmac_rx_pkt_signal
 1139 023c 0E94 0000 		call nrk_signal_register
 310:../../../src/net/bmac/rf231_soc/bmac.c ****   return (bmac_rx_pkt_signal);
 311:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1141               	.LM120:
 1142 0240 8091 0000 		lds r24,bmac_rx_pkt_signal
 1143               	/* epilogue start */
 1144 0244 0895      		ret
 1146               	.Lscope23:
 1148               		.stabd	78,0,0
 1150               	.global	bmac_get_tx_done_signal
 1152               	bmac_get_tx_done_signal:
 1153               		.stabd	46,0,0
 312:../../../src/net/bmac/rf231_soc/bmac.c **** 
 313:../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_tx_done_signal ()
 314:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1155               	.LM121:
 1156               	.LFBB24:
 1157               	/* prologue: function */
 1158               	/* frame size = 0 */
 1159               	/* stack size = 0 */
 1160               	.L__stack_usage = 0
 315:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_tx_pkt_done_signal);
 1162               	.LM122:
 1163 0246 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1164 024a 0E94 0000 		call nrk_signal_register
 316:../../../src/net/bmac/rf231_soc/bmac.c ****   return (bmac_tx_pkt_done_signal);
 317:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1166               	.LM123:
 1167 024e 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1168               	/* epilogue start */
 1169 0252 0895      		ret
 1171               	.Lscope24:
 1173               		.stabd	78,0,0
 1177               	.global	bmac_tx_pkt
 1179               	bmac_tx_pkt:
 1180               		.stabd	46,0,0
 318:../../../src/net/bmac/rf231_soc/bmac.c **** 
 319:../../../src/net/bmac/rf231_soc/bmac.c **** 
 320:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt (uint8_t * buf, uint8_t len)
 321:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1182               	.LM124:
 1183               	.LFBB25:
 1184 0254 EF92      		push r14
 1185 0256 FF92      		push r15
 1186 0258 0F93      		push r16
 1187 025a 1F93      		push r17
 1188 025c DF93      		push r29
 1189 025e CF93      		push r28
 1190 0260 0F92      		push __tmp_reg__
 1191 0262 CDB7      		in r28,__SP_L__
 1192 0264 DEB7      		in r29,__SP_H__
 1193               	/* prologue: function */
 1194               	/* frame size = 1 */
 1195               	/* stack size = 7 */
 1196               	.L__stack_usage = 7
 1197 0266 7C01      		movw r14,r24
 322:../../../src/net/bmac/rf231_soc/bmac.c ****   uint32_t mask;
 323:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_data_ready == 1)
 1199               	.LM125:
 1200 0268 8091 0000 		lds r24,tx_data_ready
 1201 026c 8130      		cpi r24,lo8(1)
 1202 026e 01F0      		breq .L50
 324:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 325:../../../src/net/bmac/rf231_soc/bmac.c **** // If reserve exists check it
 326:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 327:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve != -1) {
 328:../../../src/net/bmac/rf231_soc/bmac.c ****     if (nrk_reserve_consume (tx_reserve) == NRK_ERROR) {
 329:../../../src/net/bmac/rf231_soc/bmac.c ****       return NRK_ERROR;
 330:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 331:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 332:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 333:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_tx_pkt_done_signal);
 1204               	.LM126:
 1205 0270 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1206 0274 6983      		std Y+1,r22
 1207 0276 0E94 0000 		call nrk_signal_register
 334:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 1;
 1209               	.LM127:
 1210 027a 81E0      		ldi r24,lo8(1)
 1211 027c 8093 0000 		sts tx_data_ready,r24
 335:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.pPayload = buf;
 1213               	.LM128:
 1214 0280 F092 0000 		sts bmac_rfTxInfo+3+1,r15
 1215 0284 E092 0000 		sts bmac_rfTxInfo+3,r14
 336:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.length = len;
 1217               	.LM129:
 1218 0288 6981      		ldd r22,Y+1
 1219 028a 6093 0000 		sts bmac_rfTxInfo+2,r22
 337:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 338:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_kprintf (PSTR ("Waiting for tx done signal\r\n"));
 339:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 340:../../../src/net/bmac/rf231_soc/bmac.c ****   mask = nrk_event_wait (SIG (bmac_tx_pkt_done_signal));
 1221               	.LM130:
 1222 028e 61E0      		ldi r22,lo8(1)
 1223 0290 70E0      		ldi r23,hi8(1)
 1224 0292 80E0      		ldi r24,hlo8(1)
 1225 0294 90E0      		ldi r25,hhi8(1)
 1226 0296 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1227 029a 00C0      		rjmp 2f
 1228 029c 660F      	1:	lsl r22
 1229 029e 771F      		rol r23
 1230 02a0 881F      		rol r24
 1231 02a2 991F      		rol r25
 1232 02a4 0A94      	2:	dec r0
 1233 02a6 02F4      		brpl 1b
 1234 02a8 0E94 0000 		call nrk_event_wait
 1235 02ac 7B01      		movw r14,r22
 1236 02ae 8C01      		movw r16,r24
 341:../../../src/net/bmac/rf231_soc/bmac.c ****   if (mask == 0)
 1238               	.LM131:
 1239 02b0 6115      		cp r22,__zero_reg__
 1240 02b2 7105      		cpc r23,__zero_reg__
 1241 02b4 8105      		cpc r24,__zero_reg__
 1242 02b6 9105      		cpc r25,__zero_reg__
 1243 02b8 01F4      		brne .L47
 342:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC TX: Error calling event wait\r\n"));
 1245               	.LM132:
 1246 02ba 80E0      		ldi r24,lo8(__c.3126)
 1247 02bc 90E0      		ldi r25,hi8(__c.3126)
 1248 02be 0E94 0000 		call nrk_kprintf
 1249               	.L47:
 343:../../../src/net/bmac/rf231_soc/bmac.c ****   if ((mask & SIG (bmac_tx_pkt_done_signal)) == 0)
 1251               	.LM133:
 1252 02c2 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1253 02c6 00C0      		rjmp 2f
 1254 02c8 1695      	1:	lsr r17
 1255 02ca 0795      		ror r16
 1256 02cc F794      		ror r15
 1257 02ce E794      		ror r14
 1258 02d0 0A94      	2:	dec r0
 1259 02d2 02F4      		brpl 1b
 1260 02d4 E0FC      		sbrc r14,0
 1261 02d6 00C0      		rjmp .L48
 344:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC TX: Woke up on wrong signal\r\n"));
 1263               	.LM134:
 1264 02d8 80E0      		ldi r24,lo8(__c.3128)
 1265 02da 90E0      		ldi r25,hi8(__c.3128)
 1266 02dc 0E94 0000 		call nrk_kprintf
 1267               	.L48:
 345:../../../src/net/bmac/rf231_soc/bmac.c ****   if (pkt_got_ack)
 1269               	.LM135:
 1270 02e0 8091 0000 		lds r24,pkt_got_ack
 1271 02e4 8823      		tst r24
 1272 02e6 01F0      		breq .L50
 346:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 1274               	.LM136:
 1275 02e8 81E0      		ldi r24,lo8(1)
 1276 02ea 00C0      		rjmp .L46
 1277               	.L50:
 347:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_ERROR;
 1279               	.LM137:
 1280 02ec 8FEF      		ldi r24,lo8(-1)
 1281               	.L46:
 1282               	/* epilogue start */
 348:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1284               	.LM138:
 1285 02ee 0F90      		pop __tmp_reg__
 1286 02f0 CF91      		pop r28
 1287 02f2 DF91      		pop r29
 1288 02f4 1F91      		pop r17
 1289 02f6 0F91      		pop r16
 1290 02f8 FF90      		pop r15
 1291 02fa EF90      		pop r14
 1292 02fc 0895      		ret
 1297               	.Lscope25:
 1299               		.stabd	78,0,0
 1303               	.global	bmac_rx_pkt_get
 1305               	bmac_rx_pkt_get:
 1306               		.stabd	46,0,0
 349:../../../src/net/bmac/rf231_soc/bmac.c **** 
 350:../../../src/net/bmac/rf231_soc/bmac.c **** 
 351:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t *bmac_rx_pkt_get (uint8_t * len, int8_t * rssi)
 352:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1308               	.LM139:
 1309               	.LFBB26:
 1310               	/* prologue: function */
 1311               	/* frame size = 0 */
 1312               	/* stack size = 0 */
 1313               	.L__stack_usage = 0
 1314 02fe FC01      		movw r30,r24
 1315 0300 DB01      		movw r26,r22
 353:../../../src/net/bmac/rf231_soc/bmac.c **** 
 354:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_ready () == 0) {
 1317               	.LM140:
 1318 0302 8091 0000 		lds r24,rx_buf_empty
 1319 0306 8823      		tst r24
 1320 0308 01F0      		breq .L52
 355:../../../src/net/bmac/rf231_soc/bmac.c ****     *len = 0;
 1322               	.LM141:
 1323 030a 1082      		st Z,__zero_reg__
 356:../../../src/net/bmac/rf231_soc/bmac.c ****     *rssi = 0;
 1325               	.LM142:
 1326 030c 1C92      		st X,__zero_reg__
 357:../../../src/net/bmac/rf231_soc/bmac.c ****     return NULL;
 1328               	.LM143:
 1329 030e 20E0      		ldi r18,lo8(0)
 1330 0310 30E0      		ldi r19,hi8(0)
 1331 0312 00C0      		rjmp .L53
 1332               	.L52:
 358:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 359:../../../src/net/bmac/rf231_soc/bmac.c ****   *len = bmac_rfRxInfo.length;
 1334               	.LM144:
 1335 0314 8091 0000 		lds r24,bmac_rfRxInfo+3
 1336 0318 8083      		st Z,r24
 360:../../../src/net/bmac/rf231_soc/bmac.c ****   *rssi = bmac_rfRxInfo.rssi;
 1338               	.LM145:
 1339 031a 8091 0000 		lds r24,bmac_rfRxInfo+8
 1340 031e 8C93      		st X,r24
 361:../../../src/net/bmac/rf231_soc/bmac.c ****   return bmac_rfRxInfo.pPayload;
 1342               	.LM146:
 1343 0320 2091 0000 		lds r18,bmac_rfRxInfo+5
 1344 0324 3091 0000 		lds r19,bmac_rfRxInfo+5+1
 1345               	.L53:
 362:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1347               	.LM147:
 1348 0328 C901      		movw r24,r18
 1349               	/* epilogue start */
 1350 032a 0895      		ret
 1352               	.Lscope26:
 1354               		.stabd	78,0,0
 1356               	.global	bmac_rx_pkt_ready
 1358               	bmac_rx_pkt_ready:
 1359               		.stabd	46,0,0
 363:../../../src/net/bmac/rf231_soc/bmac.c **** 
 364:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_ready (void)
 365:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1361               	.LM148:
 1362               	.LFBB27:
 1363               	/* prologue: function */
 1364               	/* frame size = 0 */
 1365               	/* stack size = 0 */
 1366               	.L__stack_usage = 0
 366:../../../src/net/bmac/rf231_soc/bmac.c ****   return (!rx_buf_empty);
 1368               	.LM149:
 1369 032c 81E0      		ldi r24,lo8(1)
 1370 032e 9091 0000 		lds r25,rx_buf_empty
 1371 0332 9111      		cpse r25,__zero_reg__
 1372 0334 80E0      		ldi r24,lo8(0)
 1373               	.L55:
 367:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1375               	.LM150:
 1376 0336 0895      		ret
 1378               	.Lscope27:
 1380               		.stabd	78,0,0
 1382               	.global	bmac_rx_pkt_release
 1384               	bmac_rx_pkt_release:
 1385               		.stabd	46,0,0
 368:../../../src/net/bmac/rf231_soc/bmac.c **** 
 369:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_release (void)
 370:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1387               	.LM151:
 1388               	.LFBB28:
 1389               	/* prologue: function */
 1390               	/* frame size = 0 */
 1391               	/* stack size = 0 */
 1392               	.L__stack_usage = 0
 371:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 1;
 1394               	.LM152:
 1395 0338 81E0      		ldi r24,lo8(1)
 1396 033a 8093 0000 		sts rx_buf_empty,r24
 1397               	/* epilogue start */
 372:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 373:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1399               	.LM153:
 1400 033e 0895      		ret
 1402               	.Lscope28:
 1404               		.stabd	78,0,0
 1406               	.global	bmac_disable
 1408               	bmac_disable:
 1409               		.stabd	46,0,0
 374:../../../src/net/bmac/rf231_soc/bmac.c **** 
 375:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_disable ()
 376:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1411               	.LM154:
 1412               	.LFBB29:
 1413               	/* prologue: function */
 1414               	/* frame size = 0 */
 1415               	/* stack size = 0 */
 1416               	.L__stack_usage = 0
 377:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 0;
 1418               	.LM155:
 1419 0340 1092 0000 		sts is_enabled,__zero_reg__
 378:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_down ();
 1421               	.LM156:
 1422 0344 0E94 0000 		call rf_power_down
 1423               	/* epilogue start */
 379:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1425               	.LM157:
 1426 0348 0895      		ret
 1428               	.Lscope29:
 1430               		.stabd	78,0,0
 1432               	.global	bmac_enable
 1434               	bmac_enable:
 1435               		.stabd	46,0,0
 380:../../../src/net/bmac/rf231_soc/bmac.c **** 
 381:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_enable ()
 382:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1437               	.LM158:
 1438               	.LFBB30:
 1439               	/* prologue: function */
 1440               	/* frame size = 0 */
 1441               	/* stack size = 0 */
 1442               	.L__stack_usage = 0
 383:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 1;
 1444               	.LM159:
 1445 034a 81E0      		ldi r24,lo8(1)
 1446 034c 8093 0000 		sts is_enabled,r24
 384:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 1448               	.LM160:
 1449 0350 0E94 0000 		call rf_power_up
 385:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_enable_signal);
 1451               	.LM161:
 1452 0354 8091 0000 		lds r24,bmac_enable_signal
 1453 0358 0E94 0000 		call nrk_event_signal
 1454               	/* epilogue start */
 386:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1456               	.LM162:
 1457 035c 0895      		ret
 1459               	.Lscope30:
 1461               		.stabd	78,0,0
 1464               	.global	bmac_set_rx_check_rate
 1466               	bmac_set_rx_check_rate:
 1467               		.stabd	46,0,0
 387:../../../src/net/bmac/rf231_soc/bmac.c **** 
 388:../../../src/net/bmac/rf231_soc/bmac.c **** 
 389:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_nw_task ()
 390:../../../src/net/bmac/rf231_soc/bmac.c **** {
 391:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t v, i;
 392:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t e;
 393:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t backoff;
 394:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sig_mask_t event;
 395:../../../src/net/bmac/rf231_soc/bmac.c **** 
 396:../../../src/net/bmac/rf231_soc/bmac.c ****   while (bmac_started () == 0)
 397:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_next_period ();
 398:../../../src/net/bmac/rf231_soc/bmac.c **** 
 399:../../../src/net/bmac/rf231_soc/bmac.c **** //register the signal after bmac_init has been called
 400:../../../src/net/bmac/rf231_soc/bmac.c ****   v = nrk_signal_register (bmac_enable_signal);
 401:../../../src/net/bmac/rf231_soc/bmac.c ****   if (v == NRK_ERROR)
 402:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 403:../../../src/net/bmac/rf231_soc/bmac.c ****   backoff = 0;
 404:../../../src/net/bmac/rf231_soc/bmac.c ****   while (1) {
 405:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 406:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 407:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_sw_wdt_update (BMAC_SW_WDT_ID);
 408:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 409:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 410:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_power_up ();
 411:../../../src/net/bmac/rf231_soc/bmac.c ****     if (is_enabled) {
 412:../../../src/net/bmac/rf231_soc/bmac.c ****       v = 1;
 413:../../../src/net/bmac/rf231_soc/bmac.c **** 
 414:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 415:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 416:../../../src/net/bmac/rf231_soc/bmac.c ****       {
 417:../../../src/net/bmac/rf231_soc/bmac.c **** 	 if (_bmac_rx () == 1) e = nrk_event_signal (bmac_rx_pkt_signal);
 418:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 419:../../../src/net/bmac/rf231_soc/bmac.c ****       else
 420:../../../src/net/bmac/rf231_soc/bmac.c ****       e = nrk_event_signal (bmac_rx_pkt_signal);
 421:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 422:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 423:../../../src/net/bmac/rf231_soc/bmac.c ****         v = _bmac_channel_check ();
 424:../../../src/net/bmac/rf231_soc/bmac.c ****       // If the buffer is full, signal the receiving task again.
 425:../../../src/net/bmac/rf231_soc/bmac.c ****       else
 426:../../../src/net/bmac/rf231_soc/bmac.c ****         e = nrk_event_signal (bmac_rx_pkt_signal);
 427:../../../src/net/bmac/rf231_soc/bmac.c ****       // bmac_channel check turns on radio, don't turn off if
 428:../../../src/net/bmac/rf231_soc/bmac.c ****       // data is coming.
 429:../../../src/net/bmac/rf231_soc/bmac.c **** 
 430:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 0) {
 431:../../../src/net/bmac/rf231_soc/bmac.c ****         if (_bmac_rx () == 1) {
 432:../../../src/net/bmac/rf231_soc/bmac.c ****           e = nrk_event_signal (bmac_rx_pkt_signal);
 433:../../../src/net/bmac/rf231_soc/bmac.c ****           //if(e==NRK_ERROR) {
 434:../../../src/net/bmac/rf231_soc/bmac.c ****           //      nrk_kprintf( PSTR("bmac rx pkt signal failed\r\n"));
 435:../../../src/net/bmac/rf231_soc/bmac.c ****           //      printf( "errno: %u \r\n",nrk_errno_get() );
 436:../../../src/net/bmac/rf231_soc/bmac.c ****           //}
 437:../../../src/net/bmac/rf231_soc/bmac.c ****         }
 438:../../../src/net/bmac/rf231_soc/bmac.c ****         //else nrk_kprintf( PSTR("Pkt failed, buf could be corrupt\r\n" ));
 439:../../../src/net/bmac/rf231_soc/bmac.c **** 
 440:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 441:../../../src/net/bmac/rf231_soc/bmac.c **** 
 442:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 443:../../../src/net/bmac/rf231_soc/bmac.c ****       if (tx_data_ready == 1) {
 444:../../../src/net/bmac/rf231_soc/bmac.c ****         _bmac_tx ();
 445:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 446:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_rx_off ();
 447:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_power_down ();
 448:../../../src/net/bmac/rf231_soc/bmac.c **** 
 449:../../../src/net/bmac/rf231_soc/bmac.c ****       //do {
 450:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait (_bmac_check_period);
 451:../../../src/net/bmac/rf231_soc/bmac.c ****       //      if(rx_buf_empty!=1)  nrk_event_signal (bmac_rx_pkt_signal);
 452:../../../src/net/bmac/rf231_soc/bmac.c ****       //} while(rx_buf_empty!=1);
 453:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 454:../../../src/net/bmac/rf231_soc/bmac.c ****     else {
 455:../../../src/net/bmac/rf231_soc/bmac.c ****       event = 0;
 456:../../../src/net/bmac/rf231_soc/bmac.c ****       do {
 457:../../../src/net/bmac/rf231_soc/bmac.c ****         v = nrk_signal_register (bmac_enable_signal);
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 459:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 460:../../../src/net/bmac/rf231_soc/bmac.c ****       while ((event & SIG (bmac_enable_signal)) == 0);
 461:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 462:../../../src/net/bmac/rf231_soc/bmac.c ****     //nrk_wait_until_next_period();
 463:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 464:../../../src/net/bmac/rf231_soc/bmac.c **** 
 465:../../../src/net/bmac/rf231_soc/bmac.c **** }
 466:../../../src/net/bmac/rf231_soc/bmac.c **** 
 467:../../../src/net/bmac/rf231_soc/bmac.c **** 
 468:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rx_check_rate (nrk_time_t period)
 469:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1469               	.LM163:
 1470               	.LFBB31:
 1471 035e DF93      		push r29
 1472 0360 CF93      		push r28
 1473 0362 CDB7      		in r28,__SP_L__
 1474 0364 DEB7      		in r29,__SP_H__
 1475 0366 2897      		sbiw r28,8
 1476 0368 0FB6      		in __tmp_reg__,__SREG__
 1477 036a F894      		cli
 1478 036c DEBF      		out __SP_H__,r29
 1479 036e 0FBE      		out __SREG__,__tmp_reg__
 1480 0370 CDBF      		out __SP_L__,r28
 1481               	/* prologue: function */
 1482               	/* frame size = 8 */
 1483               	/* stack size = 10 */
 1484               	.L__stack_usage = 10
 1485 0372 2983      		std Y+1,r18
 1486 0374 3A83      		std Y+2,r19
 1487 0376 4B83      		std Y+3,r20
 1488 0378 5C83      		std Y+4,r21
 1489 037a 6D83      		std Y+5,r22
 1490 037c 7E83      		std Y+6,r23
 1491 037e 8F83      		std Y+7,r24
 1492 0380 9887      		std Y+8,r25
 470:../../../src/net/bmac/rf231_soc/bmac.c ****   if (period.secs == 0
 471:../../../src/net/bmac/rf231_soc/bmac.c ****       && period.nano_secs < BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS)
 472:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 473:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = period.secs;
 474:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = period.nano_secs;
 475:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1494               	.LM164:
 1495 0382 2981      		ldd r18,Y+1
 1496 0384 3A81      		ldd r19,Y+2
 1497 0386 4B81      		ldd r20,Y+3
 1498 0388 5C81      		ldd r21,Y+4
 1499 038a 8D81      		ldd r24,Y+5
 1500 038c 9E81      		ldd r25,Y+6
 1501 038e AF81      		ldd r26,Y+7
 1502 0390 B885      		ldd r27,Y+8
 470:../../../src/net/bmac/rf231_soc/bmac.c ****   if (period.secs == 0
 1504               	.LM165:
 1505 0392 2115      		cp r18,__zero_reg__
 1506 0394 3105      		cpc r19,__zero_reg__
 1507 0396 4105      		cpc r20,__zero_reg__
 1508 0398 5105      		cpc r21,__zero_reg__
 1509 039a 01F4      		brne .L60
 471:../../../src/net/bmac/rf231_soc/bmac.c ****       && period.nano_secs < BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS)
 1511               	.LM166:
 1512 039c 8030      		cpi r24,lo8(20000000)
 1513 039e 6DE2      		ldi r22,hi8(20000000)
 1514 03a0 9607      		cpc r25,r22
 1515 03a2 61E3      		ldi r22,hlo8(20000000)
 1516 03a4 A607      		cpc r26,r22
 1517 03a6 61E0      		ldi r22,hhi8(20000000)
 1518 03a8 B607      		cpc r27,r22
 1519 03aa 00F0      		brlo .L62
 1520               	.L60:
 473:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = period.secs;
 1522               	.LM167:
 1523 03ac 2093 0000 		sts _bmac_check_period,r18
 1524 03b0 3093 0000 		sts _bmac_check_period+1,r19
 1525 03b4 4093 0000 		sts _bmac_check_period+2,r20
 1526 03b8 5093 0000 		sts _bmac_check_period+3,r21
 474:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = period.nano_secs;
 1528               	.LM168:
 1529 03bc 8093 0000 		sts _bmac_check_period+4,r24
 1530 03c0 9093 0000 		sts _bmac_check_period+4+1,r25
 1531 03c4 A093 0000 		sts _bmac_check_period+4+2,r26
 1532 03c8 B093 0000 		sts _bmac_check_period+4+3,r27
 1534               	.LM169:
 1535 03cc 81E0      		ldi r24,lo8(1)
 1536 03ce 00C0      		rjmp .L61
 1537               	.L62:
 472:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1539               	.LM170:
 1540 03d0 8FEF      		ldi r24,lo8(-1)
 1541               	.L61:
 1542               	/* epilogue start */
 476:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1544               	.LM171:
 1545 03d2 2896      		adiw r28,8
 1546 03d4 0FB6      		in __tmp_reg__,__SREG__
 1547 03d6 F894      		cli
 1548 03d8 DEBF      		out __SP_H__,r29
 1549 03da 0FBE      		out __SREG__,__tmp_reg__
 1550 03dc CDBF      		out __SP_L__,r28
 1551 03de CF91      		pop r28
 1552 03e0 DF91      		pop r29
 1553 03e2 0895      		ret
 1555               	.Lscope31:
 1557               		.stabd	78,0,0
 1559               	.global	bmac_started
 1561               	bmac_started:
 1562               		.stabd	46,0,0
 477:../../../src/net/bmac/rf231_soc/bmac.c **** 
 478:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_started ()
 479:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1564               	.LM172:
 1565               	.LFBB32:
 1566               	/* prologue: function */
 1567               	/* frame size = 0 */
 1568               	/* stack size = 0 */
 1569               	.L__stack_usage = 0
 480:../../../src/net/bmac/rf231_soc/bmac.c ****   return bmac_running;
 481:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1571               	.LM173:
 1572 03e4 8091 0000 		lds r24,bmac_running
 1573               	/* epilogue start */
 1574 03e8 0895      		ret
 1576               	.Lscope32:
 1578               		.stabd	78,0,0
 1580               	.global	_bmac_channel_check
 1582               	_bmac_channel_check:
 1583               		.stabd	46,0,0
 482:../../../src/net/bmac/rf231_soc/bmac.c **** 
 483:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_channel_check ()
 484:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1585               	.LM174:
 1586               	.LFBB33:
 1587 03ea 0F93      		push r16
 1588 03ec 1F93      		push r17
 1589               	/* prologue: function */
 1590               	/* frame size = 0 */
 1591               	/* stack size = 2 */
 1592               	.L__stack_usage = 2
 485:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t val = 0;
 486:../../../src/net/bmac/rf231_soc/bmac.c **** 
 487:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1594               	.LM175:
 1595 03ee 0E94 0000 		call rf_rx_on
 488:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1597               	.LM176:
 1598 03f2 0E94 0000 		call rf_cca_check
 1599 03f6 082F      		mov r16,r24
 489:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1601               	.LM177:
 1602 03f8 0E94 0000 		call rf_cca_check
 1603 03fc 182F      		mov r17,r24
 490:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1605               	.LM178:
 1606 03fe 0E94 0000 		call rf_cca_check
 489:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1608               	.LM179:
 1609 0402 100F      		add r17,r16
 1611               	.LM180:
 1612 0404 180F      		add r17,r24
 491:../../../src/net/bmac/rf231_soc/bmac.c ****   if (val > 1)
 492:../../../src/net/bmac/rf231_soc/bmac.c ****     val = 1;
 493:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();
 1614               	.LM181:
 1615 0406 0E94 0000 		call rf_rx_off
 1616 040a 812F      		mov r24,r17
 1617 040c 1116      		cp __zero_reg__,r17
 1618 040e 04F4      		brge .L65
 1619 0410 81E0      		ldi r24,lo8(1)
 1620               	.L65:
 1621               	/* epilogue start */
 494:../../../src/net/bmac/rf231_soc/bmac.c ****   return val;
 495:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1623               	.LM182:
 1624 0412 1F91      		pop r17
 1625 0414 0F91      		pop r16
 1626 0416 0895      		ret
 1628               	.Lscope33:
 1630               		.stabd	78,0,0
 1632               	.global	_bmac_rx
 1634               	_bmac_rx:
 1635               		.stabd	46,0,0
 496:../../../src/net/bmac/rf231_soc/bmac.c **** 
 497:../../../src/net/bmac/rf231_soc/bmac.c **** // Assuming that CCA returned 1 and a packet is on its way
 498:../../../src/net/bmac/rf231_soc/bmac.c **** // Receive the packet or timeout and error
 499:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_rx ()
 500:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1637               	.LM183:
 1638               	.LFBB34:
 1639               	/* prologue: function */
 1640               	/* frame size = 0 */
 1641               	/* stack size = 0 */
 1642               	.L__stack_usage = 0
 501:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t n;
 502:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t cnt;
 503:../../../src/net/bmac/rf231_soc/bmac.c **** 
 504:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1644               	.LM184:
 1645 0418 0E94 0000 		call rf_rx_on
 505:../../../src/net/bmac/rf231_soc/bmac.c ****   cnt = 0;
 506:../../../src/net/bmac/rf231_soc/bmac.c **** //printf( "calling rx\r\n" );
 507:../../../src/net/bmac/rf231_soc/bmac.c ****   dummy_t.secs = 0;
 1647               	.LM185:
 1648 041c 1092 0000 		sts dummy_t,__zero_reg__
 1649 0420 1092 0000 		sts dummy_t+1,__zero_reg__
 1650 0424 1092 0000 		sts dummy_t+2,__zero_reg__
 1651 0428 1092 0000 		sts dummy_t+3,__zero_reg__
 508:../../../src/net/bmac/rf231_soc/bmac.c ****   dummy_t.nano_secs = 5 * NANOS_PER_MS;
 1653               	.LM186:
 1654 042c 80E4      		ldi r24,lo8(5000000)
 1655 042e 9BE4      		ldi r25,hi8(5000000)
 1656 0430 ACE4      		ldi r26,hlo8(5000000)
 1657 0432 B0E0      		ldi r27,hhi8(5000000)
 1658 0434 682F      		mov r22,r24
 1659 0436 8093 0000 		sts dummy_t+4,r24
 1660 043a 9093 0000 		sts dummy_t+4+1,r25
 1661 043e A093 0000 		sts dummy_t+4+2,r26
 1662 0442 B093 0000 		sts dummy_t+4+3,r27
 509:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_wait (dummy_t);
 1664               	.LM187:
 1665 0446 20E0      		ldi r18,lo8(0)
 1666 0448 3091 0000 		lds r19,dummy_t+1
 1667 044c 4091 0000 		lds r20,dummy_t+2
 1668 0450 5091 0000 		lds r21,dummy_t+3
 1669 0454 7091 0000 		lds r23,dummy_t+5
 1670 0458 8091 0000 		lds r24,dummy_t+6
 1671 045c 9091 0000 		lds r25,dummy_t+7
 1672 0460 0E94 0000 		call nrk_wait
 510:../../../src/net/bmac/rf231_soc/bmac.c **** 
 511:../../../src/net/bmac/rf231_soc/bmac.c ****   n = rf_rx_packet_nonblock ();
 1674               	.LM188:
 1675 0464 0E94 0000 		call rf_rx_packet_nonblock
 512:../../../src/net/bmac/rf231_soc/bmac.c **** 
 513:../../../src/net/bmac/rf231_soc/bmac.c ****   if (n != NRK_OK) {
 1677               	.LM189:
 1678 0468 8130      		cpi r24,lo8(1)
 1679 046a 01F0      		breq .L67
 514:../../../src/net/bmac/rf231_soc/bmac.c ****     if (rx_failure_cnt < 65535)
 1681               	.LM190:
 1682 046c 8091 0000 		lds r24,rx_failure_cnt
 1683 0470 9091 0000 		lds r25,rx_failure_cnt+1
 1684 0474 A091 0000 		lds r26,rx_failure_cnt+2
 1685 0478 B091 0000 		lds r27,rx_failure_cnt+3
 1686 047c 8F3F      		cpi r24,lo8(65535)
 1687 047e 2FEF      		ldi r18,hi8(65535)
 1688 0480 9207      		cpc r25,r18
 1689 0482 20E0      		ldi r18,hlo8(65535)
 1690 0484 A207      		cpc r26,r18
 1691 0486 20E0      		ldi r18,hhi8(65535)
 1692 0488 B207      		cpc r27,r18
 1693 048a 00F4      		brsh .L68
 515:../../../src/net/bmac/rf231_soc/bmac.c ****       rx_failure_cnt++;
 1695               	.LM191:
 1696 048c 0196      		adiw r24,1
 1697 048e A11D      		adc r26,__zero_reg__
 1698 0490 B11D      		adc r27,__zero_reg__
 1699 0492 8093 0000 		sts rx_failure_cnt,r24
 1700 0496 9093 0000 		sts rx_failure_cnt+1,r25
 1701 049a A093 0000 		sts rx_failure_cnt+2,r26
 1702 049e B093 0000 		sts rx_failure_cnt+3,r27
 1703               	.L68:
 516:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_rx_off ();
 1705               	.LM192:
 1706 04a2 0E94 0000 		call rf_rx_off
 517:../../../src/net/bmac/rf231_soc/bmac.c ****     return 0;
 1708               	.LM193:
 1709 04a6 80E0      		ldi r24,lo8(0)
 1710 04a8 0895      		ret
 1711               	.L67:
 518:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 519:../../../src/net/bmac/rf231_soc/bmac.c **** 
 520:../../../src/net/bmac/rf231_soc/bmac.c **** /*while ( rf_rx_packet_nonblock() != NRK_OK )
 521:../../../src/net/bmac/rf231_soc/bmac.c **** 	{
 522:../../../src/net/bmac/rf231_soc/bmac.c **** 	cnt++;
 523:../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_wait(_bmac_check_period);
 524:../../../src/net/bmac/rf231_soc/bmac.c **** 	if(cnt>2) { 
 525:../../../src/net/bmac/rf231_soc/bmac.c **** 			#ifdef DEBUG
 526:../../../src/net/bmac/rf231_soc/bmac.c **** 			printf( "rx timeout 1 %d\r\n",cnt );
 527:../../../src/net/bmac/rf231_soc/bmac.c **** 			#endif
 528:../../../src/net/bmac/rf231_soc/bmac.c **** 			if(rx_failure_cnt<65535) rx_failure_cnt++;
 529:../../../src/net/bmac/rf231_soc/bmac.c **** 			rf_rx_off();
 530:../../../src/net/bmac/rf231_soc/bmac.c **** 			return 0;
 531:../../../src/net/bmac/rf231_soc/bmac.c **** 			} 
 532:../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 533:../../../src/net/bmac/rf231_soc/bmac.c **** */
 534:../../../src/net/bmac/rf231_soc/bmac.c **** 
 535:../../../src/net/bmac/rf231_soc/bmac.c **** 
 536:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 0;
 1713               	.LM194:
 1714 04aa 1092 0000 		sts rx_buf_empty,__zero_reg__
 537:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 538:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("BMAC: SNR= %d [", bmac_rfRxInfo.rssi);
 539:../../../src/net/bmac/rf231_soc/bmac.c ****   for (uint8_t i = 0; i < bmac_rfRxInfo.length; i++)
 540:../../../src/net/bmac/rf231_soc/bmac.c ****     printf ("%c", bmac_rfRxInfo.pPayload[i]);
 541:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("]\r\n");
 542:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 543:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();
 1716               	.LM195:
 1717 04ae 0E94 0000 		call rf_rx_off
 544:../../../src/net/bmac/rf231_soc/bmac.c ****   return 1;
 1719               	.LM196:
 1720 04b2 81E0      		ldi r24,lo8(1)
 545:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1722               	.LM197:
 1723 04b4 0895      		ret
 1725               	.Lscope34:
 1727               		.stabd	78,0,0
 1729               	.global	bmac_rx_failure_count_get
 1731               	bmac_rx_failure_count_get:
 1732               		.stabd	46,0,0
 546:../../../src/net/bmac/rf231_soc/bmac.c **** 
 547:../../../src/net/bmac/rf231_soc/bmac.c **** 
 548:../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_rx_failure_count_get ()
 549:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1734               	.LM198:
 1735               	.LFBB35:
 1736               	/* prologue: function */
 1737               	/* frame size = 0 */
 1738               	/* stack size = 0 */
 1739               	.L__stack_usage = 0
 550:../../../src/net/bmac/rf231_soc/bmac.c ****   return rx_failure_cnt;
 551:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1741               	.LM199:
 1742 04b6 8091 0000 		lds r24,rx_failure_cnt
 1743 04ba 9091 0000 		lds r25,rx_failure_cnt+1
 1744               	/* epilogue start */
 1745 04be 0895      		ret
 1747               	.Lscope35:
 1749               		.stabd	78,0,0
 1751               	.global	bmac_rx_failure_count_reset
 1753               	bmac_rx_failure_count_reset:
 1754               		.stabd	46,0,0
 552:../../../src/net/bmac/rf231_soc/bmac.c **** 
 553:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t bmac_rx_failure_count_reset ()
 554:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1756               	.LM200:
 1757               	.LFBB36:
 1758               	/* prologue: function */
 1759               	/* frame size = 0 */
 1760               	/* stack size = 0 */
 1761               	.L__stack_usage = 0
 555:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_failure_cnt = 0;
 1763               	.LM201:
 1764 04c0 1092 0000 		sts rx_failure_cnt,__zero_reg__
 1765 04c4 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 1766 04c8 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 1767 04cc 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 556:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 557:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1769               	.LM202:
 1770 04d0 81E0      		ldi r24,lo8(1)
 1771               	/* epilogue start */
 1772 04d2 0895      		ret
 1774               	.Lscope36:
 1776               		.stabd	78,0,0
 1779               	.global	_b_pow
 1781               	_b_pow:
 1782               		.stabd	46,0,0
 558:../../../src/net/bmac/rf231_soc/bmac.c **** 
 559:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_tx ()
 560:../../../src/net/bmac/rf231_soc/bmac.c **** {
 561:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t v, backoff, backoff_count;
 562:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t b;
 563:../../../src/net/bmac/rf231_soc/bmac.c **** 
 564:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 565:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_kprintf (PSTR ("_bmac_tx()\r\n"));
 566:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 567:../../../src/net/bmac/rf231_soc/bmac.c ****   if (cca_active) {
 568:../../../src/net/bmac/rf231_soc/bmac.c **** 
 569:../../../src/net/bmac/rf231_soc/bmac.c **** // Add random time here to stop nodes from synchronizing with eachother
 570:../../../src/net/bmac/rf231_soc/bmac.c ****     b = _nrk_time_to_ticks (&_bmac_check_period);
 571:../../../src/net/bmac/rf231_soc/bmac.c ****     b = b / ((rand () % 10) + 1);
 572:../../../src/net/bmac/rf231_soc/bmac.c **** //printf( "waiting %d\r\n",b );
 573:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_ticks (b);
 574:../../../src/net/bmac/rf231_soc/bmac.c **** //nrk_wait_ticks(b);
 575:../../../src/net/bmac/rf231_soc/bmac.c **** 
 576:../../../src/net/bmac/rf231_soc/bmac.c ****     backoff_count = 1;
 577:../../../src/net/bmac/rf231_soc/bmac.c ****     do {
 578:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 579:../../../src/net/bmac/rf231_soc/bmac.c **** 	v=_bmac_rx();
 580:../../../src/net/bmac/rf231_soc/bmac.c **** 	v=!v;
 581:../../../src/net/bmac/rf231_soc/bmac.c ****         if (v == 1) { 
 582:../../../src/net/bmac/rf231_soc/bmac.c **** 		break; 
 583:../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 584:../../../src/net/bmac/rf231_soc/bmac.c ****         nrk_event_signal (bmac_rx_pkt_signal);
 585:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 586:../../../src/net/bmac/rf231_soc/bmac.c ****       v = _bmac_channel_check ();
 587:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 1)
 588:../../../src/net/bmac/rf231_soc/bmac.c ****         break;
 589:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 590:../../../src/net/bmac/rf231_soc/bmac.c ****       // Channel is busy
 591:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff = rand () % (_b_pow (backoff_count));
 592:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 593:../../../src/net/bmac/rf231_soc/bmac.c ****       printf ("backoff %d\r\n", backoff);
 594:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 595:../../../src/net/bmac/rf231_soc/bmac.c **** //      printf( "backoff %d\r\n",backoff );
 596:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_next_n_periods (backoff);
 597:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff_count++;
 598:../../../src/net/bmac/rf231_soc/bmac.c ****       if (backoff_count > 6)
 599:../../../src/net/bmac/rf231_soc/bmac.c ****         backoff_count = 6;      // cap it at 64    
 600:../../../src/net/bmac/rf231_soc/bmac.c ****       b = _nrk_time_to_ticks (&_bmac_check_period);
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 602:../../../src/net/bmac/rf231_soc/bmac.c **** //      printf( "waiting %d\r\n",b );
 603:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_ticks (b);
 604:../../../src/net/bmac/rf231_soc/bmac.c **** //      nrk_wait_ticks(b);
 605:../../../src/net/bmac/rf231_soc/bmac.c **** 
 606:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 607:../../../src/net/bmac/rf231_soc/bmac.c ****     while (v == 0);
 608:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 609:../../../src/net/bmac/rf231_soc/bmac.c **** 
 610:../../../src/net/bmac/rf231_soc/bmac.c ****   // send extended preamble
 611:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.cca = 0;
 612:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.ackRequest = 0;
 613:../../../src/net/bmac/rf231_soc/bmac.c **** 
 614:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t ms = _bmac_check_period.secs * 1000;
 615:../../../src/net/bmac/rf231_soc/bmac.c ****   ms += _bmac_check_period.nano_secs / 1000000;
 616:../../../src/net/bmac/rf231_soc/bmac.c ****   //printf( "CR ms: %u\n",ms );
 617:../../../src/net/bmac/rf231_soc/bmac.c ****   //target_t.nano_secs+=20*NANOS_PER_MS;
 618:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 619:../../../src/net/bmac/rf231_soc/bmac.c ****   pkt_got_ack = rf_tx_packet_repeat (&bmac_rfTxInfo, ms);
 620:../../../src/net/bmac/rf231_soc/bmac.c **** 
 621:../../../src/net/bmac/rf231_soc/bmac.c ****   // send packet
 622:../../../src/net/bmac/rf231_soc/bmac.c ****   // pkt_got_ack=rf_tx_packet (&bmac_rfTxInfo);
 623:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();                 // Just in case auto-ack left radio on
 624:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 625:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_tx_pkt_done_signal);
 626:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 627:../../../src/net/bmac/rf231_soc/bmac.c **** }
 628:../../../src/net/bmac/rf231_soc/bmac.c **** 
 629:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t _b_pow (uint8_t in)
 630:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1784               	.LM203:
 1785               	.LFBB37:
 1786               	/* prologue: function */
 1787               	/* frame size = 0 */
 1788               	/* stack size = 0 */
 1789               	.L__stack_usage = 0
 1790 04d4 982F      		mov r25,r24
 631:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t i;
 632:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t result;
 633:../../../src/net/bmac/rf231_soc/bmac.c ****   if (in <= 1)
 1792               	.LM204:
 1793 04d6 8230      		cpi r24,lo8(2)
 1794 04d8 00F0      		brlo .L76
 634:../../../src/net/bmac/rf231_soc/bmac.c ****     return 1;
 635:../../../src/net/bmac/rf231_soc/bmac.c ****   if (in > 7)
 1796               	.LM205:
 1797 04da 8830      		cpi r24,lo8(8)
 1798 04dc 00F0      		brlo .L74
 636:../../../src/net/bmac/rf231_soc/bmac.c ****     in = 6;                     // cap it at 128 
 1800               	.LM206:
 1801 04de 96E0      		ldi r25,lo8(6)
 1802               	.L74:
 637:../../../src/net/bmac/rf231_soc/bmac.c ****   result = 1;
 1804               	.LM207:
 1805 04e0 81E0      		ldi r24,lo8(1)
 638:../../../src/net/bmac/rf231_soc/bmac.c ****   for (i = 0; i < in; i++)
 1807               	.LM208:
 1808 04e2 20E0      		ldi r18,lo8(0)
 1809               	.L75:
 639:../../../src/net/bmac/rf231_soc/bmac.c ****     result = result * 2;
 1811               	.LM209:
 1812 04e4 880F      		lsl r24
 638:../../../src/net/bmac/rf231_soc/bmac.c ****   for (i = 0; i < in; i++)
 1814               	.LM210:
 1815 04e6 2F5F      		subi r18,lo8(-(1))
 1816 04e8 2917      		cp r18,r25
 1817 04ea 00F0      		brlo .L75
 1818 04ec 0895      		ret
 1819               	.L76:
 634:../../../src/net/bmac/rf231_soc/bmac.c ****     return 1;
 1821               	.LM211:
 1822 04ee 81E0      		ldi r24,lo8(1)
 640:../../../src/net/bmac/rf231_soc/bmac.c ****   return result;
 641:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1824               	.LM212:
 1825 04f0 0895      		ret
 1831               	.Lscope37:
 1833               		.stabd	78,0,0
 1835               	.global	_bmac_tx
 1837               	_bmac_tx:
 1838               		.stabd	46,0,0
 560:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1840               	.LM213:
 1841               	.LFBB38:
 1842 04f2 EF92      		push r14
 1843 04f4 FF92      		push r15
 1844 04f6 0F93      		push r16
 1845 04f8 1F93      		push r17
 1846 04fa CF93      		push r28
 1847 04fc DF93      		push r29
 1848               	/* prologue: function */
 1849               	/* frame size = 0 */
 1850               	/* stack size = 6 */
 1851               	.L__stack_usage = 6
 567:../../../src/net/bmac/rf231_soc/bmac.c ****   if (cca_active) {
 1853               	.LM214:
 1854 04fe 8091 0000 		lds r24,cca_active
 1855 0502 8823      		tst r24
 1856 0504 01F4      		brne .+2
 1857 0506 00C0      		rjmp .L80
 570:../../../src/net/bmac/rf231_soc/bmac.c ****     b = _nrk_time_to_ticks (&_bmac_check_period);
 1859               	.LM215:
 1860 0508 80E0      		ldi r24,lo8(_bmac_check_period)
 1861 050a 90E0      		ldi r25,hi8(_bmac_check_period)
 1862 050c 0E94 0000 		call _nrk_time_to_ticks
 1863 0510 EC01      		movw r28,r24
 571:../../../src/net/bmac/rf231_soc/bmac.c ****     b = b / ((rand () % 10) + 1);
 1865               	.LM216:
 1866 0512 0E94 0000 		call rand
 1867 0516 6AE0      		ldi r22,lo8(10)
 1868 0518 70E0      		ldi r23,hi8(10)
 1869 051a 0E94 0000 		call __divmodhi4
 1870 051e BC01      		movw r22,r24
 1871 0520 6F5F      		subi r22,lo8(-(1))
 1872 0522 7F4F      		sbci r23,hi8(-(1))
 1873 0524 CE01      		movw r24,r28
 1874 0526 0E94 0000 		call __udivmodhi4
 573:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_ticks (b);
 1876               	.LM217:
 1877 052a CB01      		movw r24,r22
 1878 052c 0E94 0000 		call nrk_wait_until_ticks
 576:../../../src/net/bmac/rf231_soc/bmac.c ****     backoff_count = 1;
 1880               	.LM218:
 1881 0530 FF24      		clr r15
 1882 0532 F394      		inc r15
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 1884               	.LM219:
 1885 0534 0AE0      		ldi r16,lo8(10)
 1886 0536 10E0      		ldi r17,hi8(10)
 1887               	.L85:
 586:../../../src/net/bmac/rf231_soc/bmac.c ****       v = _bmac_channel_check ();
 1889               	.LM220:
 1890 0538 0E94 0000 		call _bmac_channel_check
 1891 053c E82E      		mov r14,r24
 587:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 1)
 1893               	.LM221:
 1894 053e 8130      		cpi r24,lo8(1)
 1895 0540 01F0      		breq .L80
 591:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff = rand () % (_b_pow (backoff_count));
 1897               	.LM222:
 1898 0542 0E94 0000 		call rand
 1899 0546 EC01      		movw r28,r24
 1900 0548 8F2D      		mov r24,r15
 1901 054a 0E94 0000 		call _b_pow
 1902 054e 682F      		mov r22,r24
 1903 0550 70E0      		ldi r23,lo8(0)
 1904 0552 CE01      		movw r24,r28
 1905 0554 0E94 0000 		call __divmodhi4
 596:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_next_n_periods (backoff);
 1907               	.LM223:
 1908 0558 90E0      		ldi r25,lo8(0)
 1909 055a 0E94 0000 		call nrk_wait_until_next_n_periods
 600:../../../src/net/bmac/rf231_soc/bmac.c ****       b = _nrk_time_to_ticks (&_bmac_check_period);
 1911               	.LM224:
 1912 055e 80E0      		ldi r24,lo8(_bmac_check_period)
 1913 0560 90E0      		ldi r25,hi8(_bmac_check_period)
 1914 0562 0E94 0000 		call _nrk_time_to_ticks
 1915 0566 EC01      		movw r28,r24
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 1917               	.LM225:
 1918 0568 0E94 0000 		call rand
 1919 056c B801      		movw r22,r16
 1920 056e 0E94 0000 		call __divmodhi4
 1921 0572 BC01      		movw r22,r24
 1922 0574 6F5F      		subi r22,lo8(-(1))
 1923 0576 7F4F      		sbci r23,hi8(-(1))
 1924 0578 CE01      		movw r24,r28
 1925 057a 0E94 0000 		call __udivmodhi4
 603:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_ticks (b);
 1927               	.LM226:
 1928 057e CB01      		movw r24,r22
 1929 0580 0E94 0000 		call nrk_wait_until_ticks
 607:../../../src/net/bmac/rf231_soc/bmac.c ****     while (v == 0);
 1931               	.LM227:
 1932 0584 EE20      		tst r14
 1933 0586 01F4      		brne .L80
 597:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff_count++;
 1935               	.LM228:
 1936 0588 F394      		inc r15
 1937 058a 8F2D      		mov r24,r15
 1938 058c 8730      		cpi r24,lo8(7)
 1939 058e 00F0      		brlo .L85
 1940 0590 86E0      		ldi r24,lo8(6)
 1941 0592 F82E      		mov r15,r24
 1942 0594 00C0      		rjmp .L85
 1943               	.L80:
 611:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.cca = 0;
 1945               	.LM229:
 1946 0596 1092 0000 		sts bmac_rfTxInfo+5,__zero_reg__
 612:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.ackRequest = 0;
 1948               	.LM230:
 1949 059a 1092 0000 		sts bmac_rfTxInfo+6,__zero_reg__
 614:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t ms = _bmac_check_period.secs * 1000;
 1951               	.LM231:
 1952 059e 2091 0000 		lds r18,_bmac_check_period
 1953 05a2 3091 0000 		lds r19,_bmac_check_period+1
 1954 05a6 88EE      		ldi r24,lo8(1000)
 1955 05a8 93E0      		ldi r25,hi8(1000)
 1956 05aa 289F      		mul r18,r24
 1957 05ac E001      		movw r28,r0
 1958 05ae 299F      		mul r18,r25
 1959 05b0 D00D      		add r29,r0
 1960 05b2 389F      		mul r19,r24
 1961 05b4 D00D      		add r29,r0
 1962 05b6 1124      		clr r1
 615:../../../src/net/bmac/rf231_soc/bmac.c ****   ms += _bmac_check_period.nano_secs / 1000000;
 1964               	.LM232:
 1965 05b8 6091 0000 		lds r22,_bmac_check_period+4
 1966 05bc 7091 0000 		lds r23,_bmac_check_period+4+1
 1967 05c0 8091 0000 		lds r24,_bmac_check_period+4+2
 1968 05c4 9091 0000 		lds r25,_bmac_check_period+4+3
 1969 05c8 20E4      		ldi r18,lo8(1000000)
 1970 05ca 32E4      		ldi r19,hi8(1000000)
 1971 05cc 4FE0      		ldi r20,hlo8(1000000)
 1972 05ce 50E0      		ldi r21,hhi8(1000000)
 1973 05d0 0E94 0000 		call __udivmodsi4
 1974 05d4 C20F      		add r28,r18
 1975 05d6 D31F      		adc r29,r19
 618:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1977               	.LM233:
 1978 05d8 0E94 0000 		call rf_rx_on
 619:../../../src/net/bmac/rf231_soc/bmac.c ****   pkt_got_ack = rf_tx_packet_repeat (&bmac_rfTxInfo, ms);
 1980               	.LM234:
 1981 05dc 80E0      		ldi r24,lo8(bmac_rfTxInfo)
 1982 05de 90E0      		ldi r25,hi8(bmac_rfTxInfo)
 1983 05e0 BE01      		movw r22,r28
 1984 05e2 0E94 0000 		call rf_tx_packet_repeat
 1985 05e6 8093 0000 		sts pkt_got_ack,r24
 623:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();                 // Just in case auto-ack left radio on
 1987               	.LM235:
 1988 05ea 0E94 0000 		call rf_rx_off
 624:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 1990               	.LM236:
 1991 05ee 1092 0000 		sts tx_data_ready,__zero_reg__
 625:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_tx_pkt_done_signal);
 1993               	.LM237:
 1994 05f2 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1995 05f6 0E94 0000 		call nrk_event_signal
 627:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1997               	.LM238:
 1998 05fa 81E0      		ldi r24,lo8(1)
 1999               	/* epilogue start */
 2000 05fc DF91      		pop r29
 2001 05fe CF91      		pop r28
 2002 0600 1F91      		pop r17
 2003 0602 0F91      		pop r16
 2004 0604 FF90      		pop r15
 2005 0606 EF90      		pop r14
 2006 0608 0895      		ret
 2008               	.Lscope38:
 2010               		.stabd	78,0,0
 2012               	.global	bmac_nw_task
 2014               	bmac_nw_task:
 2015               		.stabd	46,0,0
 390:../../../src/net/bmac/rf231_soc/bmac.c **** {
 2017               	.LM239:
 2018               	.LFBB39:
 2019 060a EF92      		push r14
 2020 060c FF92      		push r15
 2021 060e 0F93      		push r16
 2022 0610 1F93      		push r17
 2023               	/* prologue: function */
 2024               	/* frame size = 0 */
 2025               	/* stack size = 4 */
 2026               	.L__stack_usage = 4
 396:../../../src/net/bmac/rf231_soc/bmac.c ****   while (bmac_started () == 0)
 2028               	.LM240:
 2029 0612 00C0      		rjmp .L87
 2030               	.L88:
 397:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_next_period ();
 2032               	.LM241:
 2033 0614 0E94 0000 		call nrk_wait_until_next_period
 2034               	.L87:
 396:../../../src/net/bmac/rf231_soc/bmac.c ****   while (bmac_started () == 0)
 2036               	.LM242:
 2037 0618 8091 0000 		lds r24,bmac_running
 2038 061c 8823      		tst r24
 2039 061e 01F0      		breq .L88
 400:../../../src/net/bmac/rf231_soc/bmac.c ****   v = nrk_signal_register (bmac_enable_signal);
 2041               	.LM243:
 2042 0620 8091 0000 		lds r24,bmac_enable_signal
 2043 0624 0E94 0000 		call nrk_signal_register
 401:../../../src/net/bmac/rf231_soc/bmac.c ****   if (v == NRK_ERROR)
 2045               	.LM244:
 2046 0628 8F3F      		cpi r24,lo8(-1)
 2047 062a 01F4      		brne .L98
 402:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 2049               	.LM245:
 2050 062c 80E0      		ldi r24,lo8(__c.3154)
 2051 062e 90E0      		ldi r25,hi8(__c.3154)
 2052 0630 0E94 0000 		call nrk_kprintf
 2053               	.L98:
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 2055               	.LM246:
 2056 0634 91E0      		ldi r25,lo8(1)
 2057 0636 E92E      		mov r14,r25
 2058 0638 F12C      		mov r15,__zero_reg__
 2059 063a 012D      		mov r16,__zero_reg__
 2060 063c 112D      		mov r17,__zero_reg__
 2061               	.L101:
 410:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_power_up ();
 2063               	.LM247:
 2064 063e 0E94 0000 		call rf_power_up
 411:../../../src/net/bmac/rf231_soc/bmac.c ****     if (is_enabled) {
 2066               	.LM248:
 2067 0642 8091 0000 		lds r24,is_enabled
 2068 0646 8823      		tst r24
 2069 0648 01F0      		breq .L99
 422:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 2071               	.LM249:
 2072 064a 8091 0000 		lds r24,rx_buf_empty
 2073 064e 8130      		cpi r24,lo8(1)
 2074 0650 01F4      		brne .L102
 423:../../../src/net/bmac/rf231_soc/bmac.c ****         v = _bmac_channel_check ();
 2076               	.LM250:
 2077 0652 0E94 0000 		call _bmac_channel_check
 430:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 0) {
 2079               	.LM251:
 2080 0656 8823      		tst r24
 2081 0658 01F4      		brne .L94
 2082               	.L93:
 431:../../../src/net/bmac/rf231_soc/bmac.c ****         if (_bmac_rx () == 1) {
 2084               	.LM252:
 2085 065a 0E94 0000 		call _bmac_rx
 2086 065e 8130      		cpi r24,lo8(1)
 2087 0660 01F4      		brne .L94
 2088               	.L102:
 432:../../../src/net/bmac/rf231_soc/bmac.c ****           e = nrk_event_signal (bmac_rx_pkt_signal);
 2090               	.LM253:
 2091 0662 8091 0000 		lds r24,bmac_rx_pkt_signal
 2092 0666 0E94 0000 		call nrk_event_signal
 2093               	.L94:
 443:../../../src/net/bmac/rf231_soc/bmac.c ****       if (tx_data_ready == 1) {
 2095               	.LM254:
 2096 066a 8091 0000 		lds r24,tx_data_ready
 2097 066e 8130      		cpi r24,lo8(1)
 2098 0670 01F4      		brne .L95
 444:../../../src/net/bmac/rf231_soc/bmac.c ****         _bmac_tx ();
 2100               	.LM255:
 2101 0672 0E94 0000 		call _bmac_tx
 2102               	.L95:
 446:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_rx_off ();
 2104               	.LM256:
 2105 0676 0E94 0000 		call rf_rx_off
 447:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_power_down ();
 2107               	.LM257:
 2108 067a 0E94 0000 		call rf_power_down
 450:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait (_bmac_check_period);
 2110               	.LM258:
 2111 067e 2091 0000 		lds r18,_bmac_check_period
 2112 0682 3091 0000 		lds r19,_bmac_check_period+1
 2113 0686 4091 0000 		lds r20,_bmac_check_period+2
 2114 068a 5091 0000 		lds r21,_bmac_check_period+3
 2115 068e 6091 0000 		lds r22,_bmac_check_period+4
 2116 0692 7091 0000 		lds r23,_bmac_check_period+5
 2117 0696 8091 0000 		lds r24,_bmac_check_period+6
 2118 069a 9091 0000 		lds r25,_bmac_check_period+7
 2119 069e 0E94 0000 		call nrk_wait
 2120 06a2 00C0      		rjmp .L101
 2121               	.L99:
 457:../../../src/net/bmac/rf231_soc/bmac.c ****         v = nrk_signal_register (bmac_enable_signal);
 2123               	.LM259:
 2124 06a4 8091 0000 		lds r24,bmac_enable_signal
 2125 06a8 0E94 0000 		call nrk_signal_register
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 2127               	.LM260:
 2128 06ac C801      		movw r24,r16
 2129 06ae B701      		movw r22,r14
 2130 06b0 0090 0000 		lds r0,bmac_enable_signal
 2131 06b4 00C0      		rjmp 2f
 2132 06b6 660F      	1:	lsl r22
 2133 06b8 771F      		rol r23
 2134 06ba 881F      		rol r24
 2135 06bc 991F      		rol r25
 2136 06be 0A94      	2:	dec r0
 2137 06c0 02F4      		brpl 1b
 2138 06c2 0E94 0000 		call nrk_event_wait
 460:../../../src/net/bmac/rf231_soc/bmac.c ****       while ((event & SIG (bmac_enable_signal)) == 0);
 2140               	.LM261:
 2141 06c6 0090 0000 		lds r0,bmac_enable_signal
 2142 06ca 00C0      		rjmp 2f
 2143 06cc 9695      	1:	lsr r25
 2144 06ce 8795      		ror r24
 2145 06d0 7795      		ror r23
 2146 06d2 6795      		ror r22
 2147 06d4 0A94      	2:	dec r0
 2148 06d6 02F4      		brpl 1b
 2149 06d8 60FF      		sbrs r22,0
 2150 06da 00C0      		rjmp .L99
 2151 06dc 00C0      		rjmp .L101
 2153               	.Lscope39:
 2155               		.stabd	78,0,0
 2157               	.global	bmac_task_config
 2159               	bmac_task_config:
 2160               		.stabd	46,0,0
 642:../../../src/net/bmac/rf231_soc/bmac.c **** 
 643:../../../src/net/bmac/rf231_soc/bmac.c **** 
 644:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_task_config ()
 645:../../../src/net/bmac/rf231_soc/bmac.c **** {
 2162               	.LM262:
 2163               	.LFBB40:
 2164 06de CF93      		push r28
 2165 06e0 DF93      		push r29
 2166               	/* prologue: function */
 2167               	/* frame size = 0 */
 2168               	/* stack size = 2 */
 2169               	.L__stack_usage = 2
 646:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_task_set_entry_function (&bmac_task, bmac_nw_task);
 2171               	.LM263:
 2172 06e2 C0E0      		ldi r28,lo8(bmac_task)
 2173 06e4 D0E0      		ldi r29,hi8(bmac_task)
 2174 06e6 CE01      		movw r24,r28
 2175 06e8 60E0      		ldi r22,lo8(gs(bmac_nw_task))
 2176 06ea 70E0      		ldi r23,hi8(gs(bmac_nw_task))
 2177 06ec 0E94 0000 		call nrk_task_set_entry_function
 647:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_task_set_stk (&bmac_task, bmac_task_stack, BMAC_STACKSIZE);
 2179               	.LM264:
 2180 06f0 CE01      		movw r24,r28
 2181 06f2 60E0      		ldi r22,lo8(bmac_task_stack)
 2182 06f4 70E0      		ldi r23,hi8(bmac_task_stack)
 2183 06f6 40E8      		ldi r20,lo8(128)
 2184 06f8 50E0      		ldi r21,hi8(128)
 2185 06fa 0E94 0000 		call nrk_task_set_stk
 648:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.prio = BMAC_TASK_PRIORITY;
 2187               	.LM265:
 2188 06fe 84E1      		ldi r24,lo8(20)
 2189 0700 8093 0000 		sts bmac_task+8,r24
 649:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.FirstActivation = TRUE;
 2191               	.LM266:
 2192 0704 81E0      		ldi r24,lo8(1)
 2193 0706 8093 0000 		sts bmac_task+7,r24
 650:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.Type = BASIC_TASK;
 2195               	.LM267:
 2196 070a 8093 0000 		sts bmac_task+9,r24
 651:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.SchType = PREEMPTIVE;
 2198               	.LM268:
 2199 070e 8093 0000 		sts bmac_task+10,r24
 652:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.period.secs = 0;
 2201               	.LM269:
 2202 0712 1092 0000 		sts bmac_task+11,__zero_reg__
 2203 0716 1092 0000 		sts bmac_task+11+1,__zero_reg__
 2204 071a 1092 0000 		sts bmac_task+11+2,__zero_reg__
 2205 071e 1092 0000 		sts bmac_task+11+3,__zero_reg__
 653:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.period.nano_secs = BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS;
 2207               	.LM270:
 2208 0722 80E0      		ldi r24,lo8(20000000)
 2209 0724 9DE2      		ldi r25,hi8(20000000)
 2210 0726 A1E3      		ldi r26,hlo8(20000000)
 2211 0728 B1E0      		ldi r27,hhi8(20000000)
 2212 072a 8093 0000 		sts bmac_task+15,r24
 2213 072e 9093 0000 		sts bmac_task+15+1,r25
 2214 0732 A093 0000 		sts bmac_task+15+2,r26
 2215 0736 B093 0000 		sts bmac_task+15+3,r27
 654:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.cpu_reserve.secs = 0;       // bmac reserve , 0 to disable
 2217               	.LM271:
 2218 073a 1092 0000 		sts bmac_task+19,__zero_reg__
 2219 073e 1092 0000 		sts bmac_task+19+1,__zero_reg__
 2220 0742 1092 0000 		sts bmac_task+19+2,__zero_reg__
 2221 0746 1092 0000 		sts bmac_task+19+3,__zero_reg__
 655:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.cpu_reserve.nano_secs = 0;
 2223               	.LM272:
 2224 074a 1092 0000 		sts bmac_task+23,__zero_reg__
 2225 074e 1092 0000 		sts bmac_task+23+1,__zero_reg__
 2226 0752 1092 0000 		sts bmac_task+23+2,__zero_reg__
 2227 0756 1092 0000 		sts bmac_task+23+3,__zero_reg__
 656:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.offset.secs = 0;
 2229               	.LM273:
 2230 075a 1092 0000 		sts bmac_task+27,__zero_reg__
 2231 075e 1092 0000 		sts bmac_task+27+1,__zero_reg__
 2232 0762 1092 0000 		sts bmac_task+27+2,__zero_reg__
 2233 0766 1092 0000 		sts bmac_task+27+3,__zero_reg__
 657:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.offset.nano_secs = 0;
 2235               	.LM274:
 2236 076a 1092 0000 		sts bmac_task+31,__zero_reg__
 2237 076e 1092 0000 		sts bmac_task+31+1,__zero_reg__
 2238 0772 1092 0000 		sts bmac_task+31+2,__zero_reg__
 2239 0776 1092 0000 		sts bmac_task+31+3,__zero_reg__
 658:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 659:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("bmac activate\r\n");
 660:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 661:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_activate_task (&bmac_task);
 2241               	.LM275:
 2242 077a CE01      		movw r24,r28
 2243 077c 0E94 0000 		call nrk_activate_task
 2244               	/* epilogue start */
 662:../../../src/net/bmac/rf231_soc/bmac.c **** }
 2246               	.LM276:
 2247 0780 DF91      		pop r29
 2248 0782 CF91      		pop r28
 2249 0784 0895      		ret
 2251               	.Lscope40:
 2253               		.stabd	78,0,0
 2254               		.comm _nrk_signal_list,4,1
 2255               		.comm nrk_idle_task_stk,128,1
 2256               		.comm nrk_kernel_stk_ptr,2,1
 2257               		.comm _nrk_prev_timer_val,1,1
 2258               		.comm _nrk_time_trigger,1,1
 2259               		.comm app_timer0_callback,2,1
 2260               		.comm app_timer0_prescale,1,1
 2261               		.comm error_task,1,1
 2262               		.comm error_num,1,1
 2263               		.comm bmac_rx_pkt_signal,1,1
 2264               		.comm bmac_tx_pkt_done_signal,1,1
 2265               		.comm bmac_enable_signal,1,1
 2266               		.comm bmac_rfRxInfo,9,1
 2267               		.comm bmac_rfTxInfo,7,1
 2268               		.lcomm bmac_task,35
 2269               		.lcomm bmac_task_stack,128
 2270               		.lcomm cca_active,1
 2271               		.lcomm _bmac_check_period,8
 2272               		.lcomm pkt_got_ack,1
 2273               		.lcomm tx_data_ready,1
 2274               		.lcomm rx_failure_cnt,4
 2275               		.lcomm dummy_t,8
 2276               		.lcomm rx_buf_empty,1
 2277               		.lcomm bmac_running,1
 2278               		.lcomm is_enabled,1
 2279               		.section	.progmem.data,"a",@progbits
 2282               	__c.3154:
 2283 0000 4661 696C 		.string	"Failed to register signal\r\n"
 2283      6564 2074 
 2283      6F20 7265 
 2283      6769 7374 
 2283      6572 2073 
 2286               	__c.3128:
 2287 001c 424D 4143 		.string	"BMAC TX: Woke up on wrong signal\r\n"
 2287      2054 583A 
 2287      2057 6F6B 
 2287      6520 7570 
 2287      206F 6E20 
 2290               	__c.3126:
 2291 003f 424D 4143 		.string	"BMAC TX: Error calling event wait\r\n"
 2291      2054 583A 
 2291      2045 7272 
 2291      6F72 2063 
 2291      616C 6C69 
 2292               		.lcomm tx_reserve,1
 2293               		.lcomm g_chan,1
 2296               	__c.3110:
 2297 0063 424D 4143 		.string	"BMAC ERROR: creating enable signal failed\r\n"
 2297      2045 5252 
 2297      4F52 3A20 
 2297      6372 6561 
 2297      7469 6E67 
 2300               	__c.3108:
 2301 008f 424D 4143 		.string	"BMAC ERROR: creating tx signal failed\r\n"
 2301      2045 5252 
 2301      4F52 3A20 
 2301      6372 6561 
 2301      7469 6E67 
 2304               	__c.3106:
 2305 00b7 424D 4143 		.string	"BMAC ERROR: creating rx signal failed\r\n"
 2305      2045 5252 
 2305      4F52 3A20 
 2305      6372 6561 
 2305      7469 6E67 
 2333               		.text
 2335               	.Letext0:
 2336               	.global __do_clear_bss
DEFINED SYMBOLS
                            *ABS*:00000000 bmac.c
     /tmp/ccDtp9NG.s:2      *ABS*:0000003f __SREG__
     /tmp/ccDtp9NG.s:3      *ABS*:0000003e __SP_H__
     /tmp/ccDtp9NG.s:4      *ABS*:0000003d __SP_L__
     /tmp/ccDtp9NG.s:5      *ABS*:00000034 __CCP__
     /tmp/ccDtp9NG.s:6      *ABS*:00000000 __tmp_reg__
     /tmp/ccDtp9NG.s:7      *ABS*:00000001 __zero_reg__
     /tmp/ccDtp9NG.s:319    .text:00000000 rf_rx_callback
     /tmp/ccDtp9NG.s:341    .text:00000002 bmac_encryption_set_ctr_counter
     /tmp/ccDtp9NG.s:377    .text:00000012 bmac_tx_reserve_set
     /tmp/ccDtp9NG.s:398    .text:00000016 bmac_tx_reserve_get
     /tmp/ccDtp9NG.s:420    .text:0000001c bmac_auto_ack_disable
     /tmp/ccDtp9NG.s:444    .text:00000024 bmac_auto_ack_enable
     /tmp/ccDtp9NG.s:468    .text:0000002c bmac_addr_decode_disable
     /tmp/ccDtp9NG.s:492    .text:00000034 bmac_addr_decode_enable
     /tmp/ccDtp9NG.s:517    .text:0000003c bmac_addr_decode_set_my_mac
     /tmp/ccDtp9NG.s:542    .text:00000044 bmac_addr_decode_dest_mac
                            *COM*:00000007 bmac_rfTxInfo
     /tmp/ccDtp9NG.s:567    .text:00000050 bmac_rx_pkt_is_encrypted
     /tmp/ccDtp9NG.s:592    .text:00000056 bmac_encryption_set_key
     /tmp/ccDtp9NG.s:626    .text:00000066 bmac_encryption_enable
     /tmp/ccDtp9NG.s:647    .text:0000006a bmac_encryption_disable
     /tmp/ccDtp9NG.s:669    .text:0000006e bmac_set_rf_power
     /tmp/ccDtp9NG.s:704    .text:0000007e bmac_set_cca_active
     /tmp/ccDtp9NG.s:2269   .bss:000000a3 cca_active
     /tmp/ccDtp9NG.s:728    .text:00000084 bmac_set_cca_thresh
     /tmp/ccDtp9NG.s:756    .text:00000092 bmac_set_channel
     /tmp/ccDtp9NG.s:2292   .bss:000000be g_chan
                            *COM*:00000009 bmac_rfRxInfo
     /tmp/ccDtp9NG.s:814    .text:000000ca bmac_wait_until_rx_pkt
     /tmp/ccDtp9NG.s:2275   .bss:000000ba rx_buf_empty
                            *COM*:00000001 bmac_rx_pkt_signal
     /tmp/ccDtp9NG.s:884    .text:0000011a bmac_rx_pkt_set_buffer
     /tmp/ccDtp9NG.s:926    .text:00000136 bmac_init
     /tmp/ccDtp9NG.s:2276   .bss:000000bb bmac_running
     /tmp/ccDtp9NG.s:2278   .bss:000000bd tx_reserve
     /tmp/ccDtp9NG.s:2273   .bss:000000ae rx_failure_cnt
     /tmp/ccDtp9NG.s:2270   .bss:000000a4 _bmac_check_period
     /tmp/ccDtp9NG.s:2304   .progmem.data:000000b7 __c.3106
                            *COM*:00000001 bmac_tx_pkt_done_signal
     /tmp/ccDtp9NG.s:2300   .progmem.data:0000008f __c.3108
                            *COM*:00000001 bmac_enable_signal
     /tmp/ccDtp9NG.s:2296   .progmem.data:00000063 __c.3110
     /tmp/ccDtp9NG.s:2272   .bss:000000ad tx_data_ready
     /tmp/ccDtp9NG.s:2277   .bss:000000bc is_enabled
     /tmp/ccDtp9NG.s:1084   .text:00000216 bmac_tx_pkt_nonblocking
     /tmp/ccDtp9NG.s:1127   .text:00000238 bmac_get_rx_pkt_signal
     /tmp/ccDtp9NG.s:1152   .text:00000246 bmac_get_tx_done_signal
     /tmp/ccDtp9NG.s:1179   .text:00000254 bmac_tx_pkt
     /tmp/ccDtp9NG.s:2290   .progmem.data:0000003f __c.3126
     /tmp/ccDtp9NG.s:2286   .progmem.data:0000001c __c.3128
     /tmp/ccDtp9NG.s:2271   .bss:000000ac pkt_got_ack
     /tmp/ccDtp9NG.s:1305   .text:000002fe bmac_rx_pkt_get
     /tmp/ccDtp9NG.s:1358   .text:0000032c bmac_rx_pkt_ready
     /tmp/ccDtp9NG.s:1384   .text:00000338 bmac_rx_pkt_release
     /tmp/ccDtp9NG.s:1408   .text:00000340 bmac_disable
     /tmp/ccDtp9NG.s:1434   .text:0000034a bmac_enable
     /tmp/ccDtp9NG.s:1466   .text:0000035e bmac_set_rx_check_rate
     /tmp/ccDtp9NG.s:1561   .text:000003e4 bmac_started
     /tmp/ccDtp9NG.s:1582   .text:000003ea _bmac_channel_check
     /tmp/ccDtp9NG.s:1634   .text:00000418 _bmac_rx
     /tmp/ccDtp9NG.s:2274   .bss:000000b2 dummy_t
     /tmp/ccDtp9NG.s:1731   .text:000004b6 bmac_rx_failure_count_get
     /tmp/ccDtp9NG.s:1753   .text:000004c0 bmac_rx_failure_count_reset
     /tmp/ccDtp9NG.s:1781   .text:000004d4 _b_pow
     /tmp/ccDtp9NG.s:1837   .text:000004f2 _bmac_tx
     /tmp/ccDtp9NG.s:2014   .text:0000060a bmac_nw_task
     /tmp/ccDtp9NG.s:2282   .progmem.data:00000000 __c.3154
     /tmp/ccDtp9NG.s:2159   .text:000006de bmac_task_config
                             .bss:00000000 bmac_task
     /tmp/ccDtp9NG.s:2268   .bss:00000023 bmac_task_stack
                            *COM*:00000004 _nrk_signal_list
                            *COM*:00000080 nrk_idle_task_stk
                            *COM*:00000002 nrk_kernel_stk_ptr
                            *COM*:00000001 _nrk_prev_timer_val
                            *COM*:00000001 _nrk_time_trigger
                            *COM*:00000002 app_timer0_callback
                            *COM*:00000001 app_timer0_prescale
                            *COM*:00000001 error_task
                            *COM*:00000001 error_num

UNDEFINED SYMBOLS
rf_security_set_ctr_counter
rf_auto_ack_disable
rf_auto_ack_enable
rf_addr_decode_disable
rf_addr_decode_enable
rf_addr_decode_set_my_mac
rf_security_last_pkt_status
rf_security_set_key
rf_tx_power
rf_set_cca_thresh
rf_power_up
rf_init
nrk_signal_register
nrk_event_wait
nrk_signal_create
nrk_kprintf
nrk_cur_task_TCB
nrk_kernel_error_add
rf_power_down
nrk_event_signal
rf_rx_on
rf_cca_check
rf_rx_off
nrk_wait
rf_rx_packet_nonblock
_nrk_time_to_ticks
rand
__divmodhi4
__udivmodhi4
nrk_wait_until_ticks
nrk_wait_until_next_n_periods
__udivmodsi4
rf_tx_packet_repeat
nrk_wait_until_next_period
nrk_task_set_entry_function
nrk_task_set_stk
nrk_activate_task
__do_clear_bss
